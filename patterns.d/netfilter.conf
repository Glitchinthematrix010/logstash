ETHTYPE (?:(?:[A-Fa-f0-9]{2}):(?:[A-Fa-f0-9]{2}))
INTERFACENAME [a-zA-Z0-9-]+
INTF_DST %{INTERFACENAME:[host][dst][interface]}
INTF_SRC %{INTERFACENAME:[host][src][interface]}
IPTABLES (?:%{IPTABLES1}|%{IPTABLES2})
IPTABLES1 IN=(?:%{INTF_SRC})? OUT=(?:%{INTF_DST})?(?: MAC=%{NETFILTERMAC})? SRC=%{IP_SRC} DST=%{IP_DST} %{IP_LEN} %{IP_TOS} %{IP_PREC} %{IP_TTL} %{IP_ID}.*SPT=%{PORT_SRC}?.*DPT=(?:%{PORT_DST})?.*
IPTABLES2 IN=(?:%{INTF_SRC})? OUT=(?:%{INTF_SRC})?(?: MAC=%{NETFILTERMAC})? SRC=%{IP_SRC} DST=%{IP_DST} %{IP_LEN} %{IP_TOS} %{IP_PREC} %{IP_TTL} %{IP_ID} (%{IP_DF})? %{IP_PROTO} SPT=%{PORT_SRC} DPT=%{PORT_DST} WINDOW=%{TCP_WINDOW} RES=%{TCP_RES} %{TCP_FLAGS} URGP=%{TCP_URGP}
MAC_DST %{MAC:[host][dst][macaddress]}
MAC_SRC %{MAC:[host][src][macaddress]}
NETFILTERMAC (?:%{MAC_SRC}:%{ETHTYPE:ethertype}:00:00)
TCP_FLAGS (?:%{TCP_BITS:[connection][tcp][flags]})
TCP_RES %{BASE16NUM:[connection][tcp][res]}
TCP_URGP %{BOOLEAN:[connection][tcp][urgent]}
TCP_WINDOW %{POSINT:[connection][tcp][window]}
