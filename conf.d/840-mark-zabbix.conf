filter {
  if [http][request][path] =~ /^\/zabbix/ and [http][response][code] and [http][response][code] < 400 {
    mutate {
      add_field => { "application" => "zabbix" }
    }
    kv {
      source => "[@metadata][param_list]"
      target => "[http][request][params]"
      prefix => "%{application}_"
      field_split => "?&"
    }
    grok {
      patterns_dir => [ "/etc/logstash/patterns.d/" ]
      tag_on_failure => [ ]
      add_tag => [ "Known Message", "Benign" ]
      match => { "[http][request][path]" => [
        "^%{SITE_ZABBIX_ROOT}$",
        "^%{SITE_ZABBIX_ROOT}favicon.ico$",
        "^%{SITE_ZABBIX_ROOT}(adm\.gui|api_jsonrpc|applications|authentication|chart(s|2|3)|dashboard|discovery|graphs|host(group)?s|httpconf|index|latest)\.php$",
        "^%{SITE_ZABBIX_ROOT}(map|popup(_httpstep)?|profile|queue|screenconf|screenedit|screens|templates|triggers|user(grp)?s|zabbix)\.php$",
        "^%{SITE_ZABBIX_ROOT}images/general/(sort_(down|up)|unknown_icon)\.png$",
        "^%{SITE_ZABBIX_ROOT}images/general/(zabbix_unknown|zabbix_available|warning2|snmp_unknown|snmp|unavailable|plus|multiselect|minus|jmx_unknown|ipmi_unknown|error3|dbl_arrow_down2|dbl_arrow_up2|chart)\.png$",
        "^%{SITE_ZABBIX_ROOT}images/general/bar/(bar_(bg|middle)|bg|left(_arr)?|right(_arr)?)\.png$",
        "^%{SITE_ZABBIX_ROOT}images/general/bttn/(arrowup|arrowdown|config|fullscreen|minus|menu|plus|reset)\.png$",
        "^%{SITE_ZABBIX_ROOT}images/general/login/(background|glow|logo)\.png$",
        "^%{SITE_ZABBIX_ROOT}images/general/zabbix\.(ico|png)$",
        "^%{SITE_ZABBIX_ROOT}images/gradients/(button|menu_not_active)\.gif$",
        "^%{SITE_ZABBIX_ROOT}img/apple-touch-icon-\d{1,3}x\d{1,3}-precomposed.png$",
        "^%{SITE_ZABBIX_ROOT}img/browser-sprite.png$",
        "^%{SITE_ZABBIX_ROOT}img/icon-sprite\.svg$",
        "^%{SITE_ZABBIX_ROOT}img/touch-icon-192x192\.png$",
        "^%{SITE_ZABBIX_ROOT}img/xtouch-icon-%{INT}x%{INT}\.png\.pagespeed\.ic\.%{DATA}\.webp$",
        "^%{SITE_ZABBIX_ROOT}js/(browsers|class\.pmaster)\.js$",
        "^%{SITE_ZABBIX_ROOT}js(Loader|rpc)\.php$",
        "^%{SITE_ZABBIX_ROOT}styles/%{DATA}pagespeed\.cf\.%{DATA}\.css$",
        "^%{SITE_ZABBIX_ROOT}styles/(blocks|color|default|icon|pages|blue-theme)\.css$",
        "^%{SITE_ZABBIX_ROOT}styles/themes/%{DATA}/(jquery-ui|main)\.css$",
        "^%{SITE_ZABBIX_ROOT}styles/themes/%{DATA}/images/bg_(flat|h-hard|i-hard)_%{INT}(_%{BASE16NUM})?\.png$",
        "^%{SITE_ZABBIX_ROOT}styles/themes/%{DATA}/images/icons_%{BASE16NUM}\.png$"
      ] }
    }
  }          
}
