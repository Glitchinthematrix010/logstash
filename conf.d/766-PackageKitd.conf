filter {
  if ([type] == "cee" or [type] == "syslog") and [syslog][identifier] == "packagekitd" {
    grok {
      patterns_dir => "/etc/logstash/patterns.d"
      tag_on_failure => [ ]
      add_tag => [ "Known Message", "Benign" ]
      match => [ "message", "^((new update|update)-packages|get-updates|refresh-cache) transaction /%{INT}_[a-f0-9]+ (scheduled )?from uid %{UID_SRC}( finished with success after %{INT}%{TIMEUNITS})?$",
                 "message", "^uid %{UID_SRC} (obtained auth for|is trying to obtain) %{DATA:[packagekit][dbus][service]}( auth \(only_trusted:0\))?$"
      ]
    }
  }
}
