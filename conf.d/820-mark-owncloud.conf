filter {
  if [type] == "apache_access" and [http][request][path] =~ /^\/owncloud/ {
    mutate {
      add_field=> { "application" => "owncloud" }
    } 
    kv {
      source => "[@metadata][param_list]"
      target => "[http][request][params]"
      prefix => "%{application}_"
      field_split => "?&"
    }
    if [http][verb] == "OPTIONS" {
      mutate {
        add_tag => [ "Known Message", "Benign" ] 
      }
    } else if [http][response][code] == 401 and [http][request][path] =~ /^\/owncloud\/remote\.php\// { 
      mutate {
        add_tag => [ "Known Message" ]
      }
    } else if [http][response][code] == 404 and [http][request][path] =~ /^\/owncloud\/index\.php\/core\/preview\.png\?/ {
      mutate {
        add_tag => [ "Known Message", "Benign" ]
      }
    } else if [http][response][code] and [http][response][code] < 400  {

      if [http][response][code] > 299 {
        mutate {
          add_tag => [ "Known Message", "Benign" ]
        }
      } else if [http][request][path] !~ /^\/owncloud\/(apps|core|index.php)/ {
        grok {
          patterns_dir => [ "/etc/logstash/patterns.d/" ]
          tag_on_failure => [ ]
          add_tag => [ "Known Message", "Benign" ]
          match => { "[http][request][path]" => [
            "^%{SITE_OC_ROOT}$",
            "^%{SITE_OC_ROOT}avatar/%{USER_DST}/%{INT}$",
            "^%{SITE_OC_ROOT}displaynames$",
            "^%{SITE_OC_ROOT}heartbeat$",
            "^%{SITE_OC_ROOT}log(in|out)(\.php)?$",
            "^%{SITE_OC_ROOT}ocs/v1\.php/apps/files_external/api/v1/mounts$",
            "^%{SITE_OC_ROOT}ocs/v1\.php/apps/files_sharing/api/v1/(remote_)?shares$",
            "^%{SITE_OC_ROOT}ocs/v1\.php/cloud/(activity|capabilities$)$",
            "^%{SITE_OC_ROOT}ocs/v2\.php/apps/files_sharing/api/v1/shares$",
            "^%{SITE_OC_ROOT}ocs/v2\.php/apps/notifications/api/v1/notifications$",
            "^%{SITE_OC_ROOT}remote\.php/$",
            "^%{SITE_OC_ROOT}remote\.php/ca(rd|l)dav/(addressbook|calendars|principals)/(%{USER_DST}/)?(contact_birthdays|defaultcalendar)?/?$",
            "^%{SITE_OC_ROOT}remote\.php/ca(rd|l)dav/?$",
            "^%{SITE_OC_ROOT}remote\.php/caldav/calendars/%{USER_DST}/defaultcalendar/[A-F0-9-]+.ics$",
            "^%{SITE_OC_ROOT}remote\.php/carddav/addressbooks/%{USER_DST}/((shard_)?contacts/([a-zA-Z0-9_./-]+)?([A-F0-9-]+.vcf)?)?$",
            "^%{SITE_OC_ROOT}remote\.php/dav$",
            "^%{SITE_OC_ROOT}remote\.php/dav/addressbooks(/users/%{USER_DST}/((shard_)?contacts/)?)?$",
            "^%{SITE_OC_ROOT}remote\.php/dav/calendars/%{USER_DST}/$",
            "^%{SITE_OC_ROOT}remote\.php/dav/comments/files/%{INT}/$",
            "^%{SITE_OC_ROOT}remote\.php/dav/principals/users/%{USER_DST}/$",
            "^%{SITE_OC_ROOT}remote\.php/dav/systemtags-relations/files/%{INT}$",
            "^%{SITE_OC_ROOT}s/%{DATA}$",
            "^%{SITE_OC_ROOT}settings/(admin|personal)$",
            "^%{SITE_OC_ROOT}settings/admin/log/entries$",
            "^%{SITE_OC_ROOT}settings/ajax/checksetup$",
            "^%{SITE_OC_ROOT}settings/apps$",
            "^%{SITE_OC_ROOT}settings/apps/(categories|experimental|list)$",
            "^%{SITE_OC_ROOT}settings/css/settings\.css$",
            "^%{SITE_OC_ROOT}settings/img/(admin|apps|help|personal|users)\.svg$",
            "^%{SITE_OC_ROOT}settings/integrity/failed$",
            "^%{SITE_OC_ROOT}settings/js/authtoken(_collection|_view)?\.js$",
            "^%{SITE_OC_ROOT}settings/js/(admin|apps|certificates|log|personal|settings)\.js$",
            "^%{SITE_OC_ROOT}status\.php$"
          ] }
        }
      } else if [http][request][path] =~ /^\/owncloud\/apps\// {
        grok {
          patterns_dir => [ "/etc/logstash/patterns.d/" ]
          tag_on_failure => [ ]
          add_tag => [ "Known Message", "Benign" ]
          match => { "[http][request][path]" => [
            "^%{SITE_OC_ROOT}apps/(provisioning_api|templateeditor|user_external|user_ldap)/img/app\.svg$",
            "^%{SITE_OC_ROOT}apps/activity/$",
            "^%{SITE_OC_ROOT}apps/activity/api/v2/activity/(all|filter)$",
            "^%{SITE_OC_ROOT}apps/activity/css/(settings|style)\.css$",
            "^%{SITE_OC_ROOT}apps/activity/img/(activity|(add|delete)-color|change)\.svg$",
            "^%{SITE_OC_ROOT}apps/activity/js/(filesplugin|formatter|settings|script)\.js$",
            "^%{SITE_OC_ROOT}apps/activity/js/activity(collection|model|tabview)\.js$",
            "^%{SITE_OC_ROOT}apps/announcementcenter/css/style\.css$",
            "^%{SITE_OC_ROOT}apps/announcementcenter/img/announcementcenter\.svg$",
            "^%{SITE_OC_ROOT}apps/announcementcenter/js/script\.js$",
            "^%{SITE_OC_ROOT}apps/bookmarks/css/3rdparty/jquery\.tagit\.css$",
            "^%{SITE_OC_ROOT}apps/bookmarks/css/bookmarks\.css$",
            "^%{SITE_OC_ROOT}apps/bookmarks/img/bookmarks\.svg$",
            "^%{SITE_OC_ROOT}apps/bookmarks/js/(bookmarks|settings)\.js$",
            "^%{SITE_OC_ROOT}apps/bookmarks/js/3rdparty/(js_tpl|tag-it)\.js$",
            "^%{SITE_OC_ROOT}apps/c(ontacts|alendar)/js/loader\.js$",
            "^%{SITE_OC_ROOT}apps/calendar/3rdparty/chosen/(cs|j)s/chosen(\.jquery\.min)?\.(css|js)$",
            "^%{SITE_OC_ROOT}apps/calendar/3rdparty/fullcalendar/(cs|j)s/fullcalendar\.(cs|j)s$",
            "^%{SITE_OC_ROOT}apps/calendar/3rdparty/jquery\.multiselect/(cs|j)s/jquery\.multiselect\.(cs|j)s$",
            "^%{SITE_OC_ROOT}apps/calendar/3rdparty/jsTz/jstz-[\d.]+\.min\.js$",
            "^%{SITE_OC_ROOT}apps/calendar/3rdparty/miniColors/(cs|j)s/jquery\.miniColors\.(min\.)?(cs|j)s$",
            "^%{SITE_OC_ROOT}apps/calendar/3rdparty/timepicker/(cs|j)s/jquery\.ui\.timepicker\.(cs|j)s$",
            "^%{SITE_OC_ROOT}apps/calendar/css/(calendar(list)?|datepicker|eventdialog|globals|settings|share|style)\.css$",
            "^%{SITE_OC_ROOT}apps/calendar/img/(calendar|(left|right)arrow)\.svg$",
            "^%{SITE_OC_ROOT}apps/calendar/img/favicon\.ico$",
            "^%{SITE_OC_ROOT}apps/calendar/js/(calendar|on-event|settings|share|jquery\.multi-autocomplete).js$",
            "^%{SITE_OC_ROOT}apps/calendar/js/public/app\.js$",
            "^%{SITE_OC_ROOT}apps/calendar/js/vendor/angular-bootstrap/ui-bootstrap(-tpls)?\.min\.js$",
            "^%{SITE_OC_ROOT}apps/calendar/js/vendor/angular-route/angular-route\.js$",
            "^%{SITE_OC_ROOT}apps/calendar/js/vendor/angular-ui-calendar/src/calendar\.js$",
            "^%{SITE_OC_ROOT}apps/calendar/js/vendor/angular/angular\.js$",
            "^%{SITE_OC_ROOT}apps/calendar/js/vendor/davclient\.js/lib/client\.js$",
            "^%{SITE_OC_ROOT}apps/calendar/js/vendor/fullcalendar/dist/fullcalendar\.(cs|j)s$",
            "^%{SITE_OC_ROOT}apps/calendar/js/vendor/fullcalendar/dist/lang-all\.js$",
            "^%{SITE_OC_ROOT}apps/calendar/js/vendor/ical\.js/build/ical\.js$",
            "^%{SITE_OC_ROOT}apps/calendar/js/vendor/jquery-timepicker/jquery\.ui\.timepicker\.css$",
            "^%{SITE_OC_ROOT}apps/calendar/js/vendor/jquery-timepicker/jquery\.ui\.timepicker\.js$",
            "^%{SITE_OC_ROOT}apps/calendar/js/vendor/jstzdetect/jstz\.min\.js$",
            "^%{SITE_OC_ROOT}apps/calendar/templates/colorpicker\.html$",
            "^%{SITE_OC_ROOT}apps/comments/css/comments\.css$",
            "^%{SITE_OC_ROOT}apps/comments/js/(app|comment(collection|model|stabview|summarymodel)|filesplugin)\.js$",
            "^%{SITE_OC_ROOT}apps/contacts/$",
            "^%{SITE_OC_ROOT}apps/contacts/css/(contacts|multi-select|share)\.css$",
            "^%{SITE_OC_ROOT}apps/contacts/css/jquery\.(Jcrop\.min|ocaddnew)\.css$",
            "^%{SITE_OC_ROOT}apps/contacts/css/public/style\.css$",
            "^%{SITE_OC_ROOT}apps/contacts/img/(app|contacts)\.svg$",
            "^%{SITE_OC_ROOT}apps/contacts/img/favicon\.ico$",
            "^%{SITE_OC_ROOT}apps/contacts/js/(addressbooks|app|contacts|groups|jquery\.ocaddnew|modernizr\.custom|otherbackendconfig|share|storage)\.js$",
            "^%{SITE_OC_ROOT}apps/contacts/js/dav/dav\.js$",
            "^%{SITE_OC_ROOT}apps/contacts/js/public/script\.js$",
            "^%{SITE_OC_ROOT}apps/contacts/js/vendor/angular-bootstrap/ui-bootstrap(-tpls)?\.min\.js$",
            "^%{SITE_OC_ROOT}apps/contacts/js/vendor/angular-cache/dist/angular-cache\.js$",
            "^%{SITE_OC_ROOT}apps/contacts/js/vendor/angular-route/angular-route\.js$",
            "^%{SITE_OC_ROOT}apps/contacts/js/vendor/angular-sanitize/angular-sanitize\.js$",
            "^%{SITE_OC_ROOT}apps/contacts/js/vendor/angular-uuid4/angular-uuid4\.js$",
            "^%{SITE_OC_ROOT}apps/contacts/js/vendor/angular/angular\.js$",
            "^%{SITE_OC_ROOT}apps/contacts/js/vendor/jquery-timepicker/jquery\.ui\.timepicker\.js$",
            "^%{SITE_OC_ROOT}apps/contacts/js/vendor/ui-select/dist/select\.js$",
            "^%{SITE_OC_ROOT}apps/contacts/js/vendor/vcard/src/vcard\.js$",
            "^%{SITE_OC_ROOT}apps/contacts/templates/(addressBook(List)?|avatar|contact(Details|Import|List)?|group(List)?|newContactButton)\.html$",
            "^%{SITE_OC_ROOT}apps/contacts/templates/detailItems/(adr|groups|group(List)?|hidden|n|tel|text(area)?)\.html$",
            "^%{SITE_OC_ROOT}apps/contacts/vendor/blueimp-file-upload/js/jquery\.fileupload\.js$",
            "^%{SITE_OC_ROOT}apps/contacts/vendor/blueimp-md5/js/md5\.min\.js$",
            "^%{SITE_OC_ROOT}apps/contacts/vendor/combobox\.js$",
            "^%{SITE_OC_ROOT}apps/contacts/vendor/jcrop/js/jquery\.Jcrop\.min\.js$",
            "^%{SITE_OC_ROOT}apps/contacts/vendor/ui-multiselect/jquery\.multiselect\.css$",
            "^%{SITE_OC_ROOT}apps/contacts/vendor/ui-multiselect/src/jquery\.multiselect\.js$",
            "^%{SITE_OC_ROOT}apps/direct_menu/css/direct_menu\.css$",
            "^%{SITE_OC_ROOT}apps/direct_menu/styles$",
            "^%{SITE_OC_ROOT}apps/documents/css/(share|style)\.css$",
            "^%{SITE_OC_ROOT}apps/documents/css//?3rdparty/webodf/(dojo-app|wodotexteditor|wodocollabpane)\.css$",
            "^%{SITE_OC_ROOT}apps/documents/css/fonts\.css$",
            "^%{SITE_OC_ROOT}apps/documents/img/documents\.svg$",
            "^%{SITE_OC_ROOT}apps/documents/js/(admin|documents|personal|share)\.js$",
            "^%{SITE_OC_ROOT}apps/documents/js/3rdparty/resources/dijit/themes/claro/claro\.css$",
            "^%{SITE_OC_ROOT}apps/documents/js/3rdparty/resources/dojo/resources/blank\.gif$",
            "^%{SITE_OC_ROOT}apps/documents/js/3rdparty/resources/dojox/layout/resources/ExpandoPane\.css$",
            "^%{SITE_OC_ROOT}apps/documents/js/3rdparty/resources/dojox/widget/ColorPicker/ColorPicker\.css$",
            "^%{SITE_OC_ROOT}apps/documents/js/3rdparty/webodf/(dojo-amalgamation|webodf-debug)\.js$",
            "^%{SITE_OC_ROOT}apps/documents/js/3rdparty/webodf/editor/(Editor(Session)?|MemberListView|Tools)\.js$",
            "^%{SITE_OC_ROOT}apps/documents/js/3rdparty/webodf/editor/widgets/(aboutDialog|annotation|editHyperlinks|fontPicker|imageInserter|paragraphAlignment|paragraphStylesDialog|simpleStyles|undoRedoMenu)\.js$",
            "^%{SITE_OC_ROOT}apps/documents/js/3rdparty/webodf/editor/widgets/dialogWidgets/(editHyperlinkPane|idMangler)\.js$",
            "^%{SITE_OC_ROOT}apps/documents/js/3rdparty/webodf/editor/widgets/toolbarWidgets/currentStyle\.js$",
            "^%{SITE_OC_ROOT}apps/documents/js/viewer/viewer\.js$",
            "^%{SITE_OC_ROOT}apps/documents/js/widgets/(oc(Close|Logo|Share|Toolbar)|titleBar|zoomCombo)\.js$",
            "^%{SITE_OC_ROOT}apps/encryption/img/app\.svg$",
            "^%{SITE_OC_ROOT}apps/external/%{INT}$",
            "^%{SITE_OC_ROOT}apps/external/css/style\.css$",
            "^%{SITE_OC_ROOT}apps/external/img/external\.svg$",
            "^%{SITE_OC_ROOT}apps/external/js/(admin|external)\.js$",
            "^%{SITE_OC_ROOT}apps/federatedfilesharing/css/3rdparty/gs-share/style\.css$",
            "^%{SITE_OC_ROOT}apps/federatedfilesharing/css/settings-personal\.css$",
            "^%{SITE_OC_ROOT}apps/federatedfilesharing/img/social-(diaspora|facebook|gnu|googleplus|twitter)\.svg$",
            "^%{SITE_OC_ROOT}apps/federatedfilesharing/js/3rdparty/gs-share/gs-share\.js$",
            "^%{SITE_OC_ROOT}apps/federatedfilesharing/js/settings-(admin|personal)\.js$",
            "^%{SITE_OC_ROOT}apps/federation/css/settings-admin\.css$",
            "^%{SITE_OC_ROOT}apps/federation/img/app\.svg$",
            "^%{SITE_OC_ROOT}apps/federation/js/settings-admin\.js$",
            "^%{SITE_OC_ROOT}apps/files/?$",
            "^%{SITE_OC_ROOT}apps/files/ajax/upload\.php$",
            "^%{SITE_OC_ROOT}apps/files/api/v1/sorting$",
            "^%{SITE_OC_ROOT}apps/files/api/v1/tags/_%{DATA}_/files$",
            "^%{SITE_OC_ROOT}apps/files/css/(detailsView|files|mobile|upload)\.css$",
            "^%{SITE_OC_ROOT}apps/files/img/(delete|external|folder|public|share|star)\.svg$",
            "^%{SITE_OC_ROOT}apps/files/js/(admin|app|breadcrumb|detailfileinfoview|detailsview|detailtabview|favoritesfilelist|files|filesummary|file-upload|favoritesplugin|fileactions|fileactionsmenu|fileinfomodel|filelist|keyboardshortcuts|mainfileinfodetailview|navigation|newfilemenu|search|tagsplugin|upload)\.js$",
            "^%{SITE_OC_ROOT}apps/files/js/jquery(\.fileupload|\.iframe-transport|-visibility)\.js$",
            "^%{SITE_OC_ROOT}apps/files_(external|pdfviewer|sharing|texteditor|trashbin|versions|videoplayer)/img/app\.svg$",
            "^%{SITE_OC_ROOT}apps/files_antivirus/img/app\.svg$",
            "^%{SITE_OC_ROOT}apps/files_external/css/(external|settings)\.css$",
            "^%{SITE_OC_ROOT}apps/files_external/globalstorages(/%{INT})?$",
            "^%{SITE_OC_ROOT}apps/files_external/js/(app|dropbox|gdrive|mountsfilelist|rollingqueue|statusmanager|oauth(1|2)|public_key|settings)\.js$",
            "^%{SITE_OC_ROOT}apps/files_external/user(global)?storages$",
            "^%{SITE_OC_ROOT}apps/files_reader/img/app\.svg$",
            "^%{SITE_OC_ROOT}apps/files_versions/preview$",
            "^%{SITE_OC_ROOT}apps/files_mv/css/mv\.css$",
            "^%{SITE_OC_ROOT}apps/files_mv/js/move\.js$",
            "^%{SITE_OC_ROOT}apps/files_pdfviewer/css/(style|viewer)\.css$",
            "^%{SITE_OC_ROOT}apps/files_pdfviewer/img/toolbarButton-secondaryToolbarClose\.svg$",
            "^%{SITE_OC_ROOT}apps/files_pdfviewer/js/(previewplugin|workersrc)\.js$",
            "^%{SITE_OC_ROOT}apps/files_pdfviewer/vendor/pdfjs/build/pdf(\.worker)?\.js$",
            "^%{SITE_OC_ROOT}apps/files_pdfviewer/vendor/pdfjs/web/(compatibility|l10n)\.js$",
            "^%{SITE_OC_ROOT}apps/files_pdfviewer/vendor/pdfjs/web/images/(loading-(icon|small)|toolbarButton-(bookmark|download|openFile|presentationMode|print|search)|shadow)\.(gif|png)$",
            "^%{SITE_OC_ROOT}apps/files_pdfviewer/vendor/pdfjs/web/images/texture\.png$",
            "^%{SITE_OC_ROOT}apps/files_pdfviewer/vendor/pdfjs/web/images/toolbarButton-(menuArrows|page(|Down|Up)|secondaryToolbarToggle|sidebarToggle|view(Attachments|Outline|Thumbnail)|zoom(In|Out))\.png$",
            "^%{SITE_OC_ROOT}apps/files_pdfviewer/vendor/pdfjs/web/locale/en-US/viewer\.properties$",
            "^%{SITE_OC_ROOT}apps/files_pdfviewer/vendor/pdfjs/web/locale/locale.properties$",
            "^%{SITE_OC_ROOT}apps/files_pdfviewer/vendor/pdfjs/web/viewer\.(j|cs)s$",
            "^%{SITE_OC_ROOT}apps/files_reader/js/plugin\.js$",
            "^%{SITE_OC_ROOT}apps/files_sharing/css/3rdparty/gs-share/style\.css$",
            "^%{SITE_OC_ROOT}apps/files_sharing/css/settings-personal\.css$",
            "^%{SITE_OC_ROOT}apps/files_sharing/css/sharetabview\.css$",
            "^%{SITE_OC_ROOT}apps/files_sharing/img/social-(diaspora|facebook|gnu|googleplus|twitter)\.svg$",
            "^%{SITE_OC_ROOT}apps/files_sharing/js/(app|external|settings-admin|share|sharedfilelist|sharetabview)\.js$",
            "^%{SITE_OC_ROOT}apps/files_sharing/js/3rdparty/gs-share/gs-share\.js$",
            "^%{SITE_OC_ROOT}apps/files_sharing/js/settings-personal\.js$",
            "^%{SITE_OC_ROOT}apps/files_texteditor/ajax/(load|save)file$",
            "^%{SITE_OC_ROOT}apps/files_texteditor/css/(mobile|style)\.css$",
            "^%{SITE_OC_ROOT}apps/files_texteditor/css/DroidSansMono/stylesheet\.css$",
            "^%{SITE_OC_ROOT}apps/files_texteditor/js/editor\.js$",
            "^%{SITE_OC_ROOT}apps/files_texteditor/js/vendor/ace/src-noconflict/(ace|mode-(html|python)|theme-clouds)\.js$",
            "^%{SITE_OC_ROOT}apps/files_trashbin/css/trash\.css$",
            "^%{SITE_OC_ROOT}apps/files_trashbin/js/(app|filelist)\.js$",
            "^%{SITE_OC_ROOT}apps/files_versions/preview$",
            "^%{SITE_OC_ROOT}apps/files_versions/ajax/getVersions.php$",
            "^%{SITE_OC_ROOT}apps/files_versions/css/versions\.css$",
            "^%{SITE_OC_ROOT}apps/files_versions/js/(filesplugin|versioncollection|versionmodel|versionstabview)\.js$",
            "^%{SITE_OC_ROOT}apps/files_video(play|view)er/css/(style|mediaelementplayer)\.css$",
            "^%{SITE_OC_ROOT}apps/files_video(play|view)er/js/viewer\.js$",
            "^%{SITE_OC_ROOT}apps/firstrunwizard/css/(colorbox|firstrunwizard)\.css$",
            "^%{SITE_OC_ROOT}apps/firstrunwizard/img/app\.svg$",
            "^%{SITE_OC_ROOT}apps/firstrunwizard/js/(firstrunwizard|jquery\.colorbox)\.js$",
            "^%{SITE_OC_ROOT}apps/gallery/$",
            "^%{SITE_OC_ROOT}apps/gallery/(slideshow|thumbnails)$",
            "^%{SITE_OC_ROOT}apps/gallery/config$",
            "^%{SITE_OC_ROOT}apps/gallery/css/(gallerybutton|github-markdown|mobile|share|slideshow|styles)\.css$",
            "^%{SITE_OC_ROOT}apps/gallery/css/upload\.css$",
            "^%{SITE_OC_ROOT}apps/gallery/files/list$",
            "^%{SITE_OC_ROOT}apps/gallery/img/(app|date(asc|des)|name(asc|des)|toggle)\.svg$",
            "^%{SITE_OC_ROOT}apps/gallery/js/(app|breadcrumb|eventsource|gallery(album|config|image|infobox|row|view)?|thumbnail)\.js$",
            "^%{SITE_OC_ROOT}apps/gallery/js/gallery(button|fileaction|utility)\.js$",
            "^%{SITE_OC_ROOT}apps/gallery/js/slideshow(controls|zoomablepreview)?\.js$",
            "^%{SITE_OC_ROOT}apps/gallery/js/upload-helper\.js$",
            "^%{SITE_OC_ROOT}apps/gallery/js/vendor/bigshot/bigshot-compressed\.js$",
            "^%{SITE_OC_ROOT}apps/gallery/js/vendor/commonmark/dist/commonmark\.min\.js$",
            "^%{SITE_OC_ROOT}apps/gallery/js/vendor/dompurify/src/purify\.js$",
            "^%{SITE_OC_ROOT}apps/gallery/js/vendor/jquery-touch-events/src/[0-9.]+/jquery\.mobile-events\.min\.js$",
            "^%{SITE_OC_ROOT}apps/gallery/js/vendor/jquery\.ui\.touch-punch-custom\.js$",
            "^%{SITE_OC_ROOT}apps/gallery/js/vendor/modified-eventsource-polyfill/eventsource-polyfill\.js$",
            "^%{SITE_OC_ROOT}apps/gallery/js/vendor/owncloud/(newfilemenu|share)\.js$",
            "^%{SITE_OC_ROOT}apps/gallery/preview/%{INT}$",
            "^%{SITE_OC_ROOT}apps/music/css/(mobile|settings-user|style|style-controls|style-sidebar|tablet)\.css$",
            "^%{SITE_OC_ROOT}apps/music/img/(music|pause-big|play-big|play-next|play-previous|repeat|shuffle)\.svg$",
            "^%{SITE_OC_ROOT}apps/music/js/app/playerwrapper\.js$",
            "^%{SITE_OC_ROOT}apps/music/js/public/(app|fileactions|musicFilePlayer|settings-user)\.js$",
            "^%{SITE_OC_ROOT}apps/music/js/vendor/angular-gettext/dist/angular-gettext\.min\.js$",
            "^%{SITE_OC_ROOT}apps/music/js/vendor/angular-route/angular-route\.min\.js$",
            "^%{SITE_OC_ROOT}apps/music/js/vendor/angular/angular\.min\.js$",
            "^%{SITE_OC_ROOT}apps/music/js/vendor/aurora/(aurora|flac|mp3)\.js$",
            "^%{SITE_OC_ROOT}apps/music/js/vendor/restangular/dist/restangular\.min\.js$",
            "^%{SITE_OC_ROOT}apps/music/js/vendor/soundmanager/script/soundmanager2-nodebug-jsmin\.js$",
            "^%{SITE_OC_ROOT}apps/music/js/vendor/underscore/underscore-min\.js$",
            "^%{SITE_OC_ROOT}apps/notifications/css/styles\.css$",
            "^%{SITE_OC_ROOT}apps/notifications/img/notifications\.svg$",
            "^%{SITE_OC_ROOT}apps/notifications/js/(app|notification)\.js$",
            "^%{SITE_OC_ROOT}apps/ownnote/%{NOTSPACE}\.(gif|jpg|png)$",
            "^%{SITE_OC_ROOT}apps/ownnote/?$",
            "^%{SITE_OC_ROOT}apps/ownnote/ajax/v0\.2/ownnote/ajax(announcement|create|del|edit|index|ren|save)$",
            "^%{SITE_OC_ROOT}apps/ownnote/css/style\.css$",
            "^%{SITE_OC_ROOT}apps/ownnote/img/(delete(-hover)?|triangle-n)\.png$",
            "^%{SITE_OC_ROOT}apps/ownnote/img/(app|triangle-n)\.svg$",
            "^%{SITE_OC_ROOT}apps/ownnote/js/(admin|script)\.js$",
            "^%{SITE_OC_ROOT}apps/ownnote/js/tinymce/plugins/(advlist|anchor|autolink|autoresize|bdesk_photo|charmap|code|context_menu|fullscreen|insertdatetime|link|lists|media|preview|print|searchreplace|table|visualblocks)/plugin\.min\.js$",
            "^%{SITE_OC_ROOT}apps/ownnote/js/tinymce/plugins/contextmenu/plugin\.min\.js$",
            "^%{SITE_OC_ROOT}apps/ownnote/js/tinymce/skins/lightgray/content\.min\.css$",
            "^%{SITE_OC_ROOT}apps/ownnote/js/tinymce/skins/lightgray/fonts/tinymce\.woff$",
            "^%{SITE_OC_ROOT}apps/ownnote/js/tinymce/skins/lightgray/skin\.min\.css$",
            "^%{SITE_OC_ROOT}apps/ownnote/js/tinymce/themes/modern/theme\.min\.js$",
            "^%{SITE_OC_ROOT}apps/ownnote/js/tinymce/tinymce\.min\.js$",
            "^%{SITE_OC_ROOT}apps/ownnote/l10n/en\.js$",
            "^%{SITE_OC_ROOT}apps/search_lucene/css/lucene\.css$",
            "^%{SITE_OC_ROOT}apps/search_lucene/js/checker\.js$",
            "^%{SITE_OC_ROOT}apps/shorten/js/(admin|script)\.js$",
            "^%{SITE_OC_ROOT}apps/systemtags/css/systemtagsfilelist\.css$",
            "^%{SITE_OC_ROOT}apps/systemtags/img/tag\.svg$",
            "^%{SITE_OC_ROOT}apps/systemtags/js/(app|filesplugin|systemtagsfilelist|systemtagsinfoview)\.js$",
            "^%{SITE_OC_ROOT}apps/templateeditor/css/settings-admin\.css$",
            "^%{SITE_OC_ROOT}apps/templateeditor/js/settings-admin\.js$",
            "^%{SITE_OC_ROOT}apps/user_ldap/ajax/((get|test)Configuration|wizard)\.php$",
            "^%{SITE_OC_ROOT}apps/user_ldap/css/settings\.css$",
            "^%{SITE_OC_ROOT}apps/user_ldap/img/copy\.svg$",
            "^%{SITE_OC_ROOT}apps/user_ldap/js/wizard/(configModel|controller|view|wizard)\.js$",
            "^%{SITE_OC_ROOT}apps/user_ldap/js/wizard/wizardDetector(AvailableAttributes|BaseDN|ClearGroupMappings|ClearUserMappings|EmailAttribute|FeatureAbstract|FilterGroup|FilterLogin|FilterUser|Generic|GroupCount|GroupObjectClasses|GroupsForUsers|Port|Queue|SimpleRequestAbstract|TestAbstract|TestBaseDN|TestConfiguration|TestLoginName|UserCount|UserDisplayNameAttribute|UserGroupAssociation|UserObjectClasses)\.js$",
            "^%{SITE_OC_ROOT}apps/user_ldap/js/wizard/wizardDetectorGroupsForGroups\.js$",
            "^%{SITE_OC_ROOT}apps/user_ldap/js/wizard/wizardFilterOnType(Factory)?\.js$",
            "^%{SITE_OC_ROOT}apps/user_ldap/js/wizard/wizardObject\.js$",
            "^%{SITE_OC_ROOT}apps/user_ldap/js/wizard/wizardTab(AbstractFilter|Advanced|Elementary|Expert|Generic|GroupFilter|LoginFilter|UserFilter)\.js$",
            "^%{SITE_OC_ROOT}apps/user_ldap/vendor/ui-multiselect/jquery\.multiselect\.css$",
            "^%{SITE_OC_ROOT}apps/user_ldap/vendor/ui-multiselect/src/jquery\.multiselect\.js$"
          ] }
        }
      } else if [http][request][path] =~ /^\/owncloud\/core/ {
        grok {
          patterns_dir => [ "/etc/logstash/patterns.d/" ]
          tag_on_failure => [ ]
          add_tag => [ "Known Message", "Benign" ]
          match => { "[http][request][path]" => [
            "^%{SITE_OC_ROOT}core/ajax/update\.php$",
            "^%{SITE_OC_ROOT}core/css/(apps|fixes|fonts|header|icons|jquery\.ocdialog|jquery-ui-fixes|mobile|multiselect|share|styles|tooltip)\.css$",
            "^%{SITE_OC_ROOT}core/css/global\.css$",
            "^%{SITE_OC_ROOT}core/css/images/ui-(icons|bg_flat|bg_glass|bg_flat|bg_highlight-soft)(_\d+)?_%{BASE16NUM}_%{INT}x%{INT}\.png$",
            "^%{SITE_OC_ROOT}core/css/images/ui-bg_(flat|glass|highlight-soft)_%{INT}_%{BASE16NUM}_%{INT}x%{INT}\.png$",
            "^%{SITE_OC_ROOT}core/css/images/ui-icons_%{BASE16NUM}_%{INT}x%{INT}\.png$",
            "^%{SITE_OC_ROOT}core/css/(inputs|systemtags)\.css$",
            "^%{SITE_OC_ROOT}core/css/systemtags\.css$",
            "^%{SITE_OC_ROOT}core/doc/user/_static/(bootstrap-sphinx|doctools|jquery(-1\.11\.0.min|-fix)?|main\.min|pygments|styles|underscore)\.css$",
            "^%{SITE_OC_ROOT}core/doc/user/_static/bootstrap-3\.1\.0/js/bootstrap\.min\.js$",
            "^%{SITE_OC_ROOT}core/doc/user/_static/fonts/OpenSans-(Bold|Light)\.woff$",
            "^%{SITE_OC_ROOT}core/doc/user/index\.html$",
            "^%{SITE_OC_ROOT}core/fonts/OpenSans-(Light|Regular|Semibold)\.woff$",
            "^%{SITE_OC_ROOT}core/img/(appstore|background|breadcrumb|desktopapp|favicon|googleplay|loading|loading-dark|loading-small|logo-icon)\.(gif|jpg|png|svg)$",
            "^%{SITE_OC_ROOT}core/img/actions/((down|up)load-white|search)\.svg$",
            "^%{SITE_OC_ROOT}core/img/actions/(add|caret|checkbox(-checked(close)?|-disabled)?|confirm|delete(-white)?|download|history|info)\.svg$",
            "^%{SITE_OC_ROOT}core/img/actions/(checkmark|checkmark-white|close|details|info|mail|rename|starred|upload|public|delete-hover|view-close|view-next|view-pause|view-play|view-previous)\.svg$",
            "^%{SITE_OC_ROOT}core/img/actions/(info|search)\.png$",
            "^%{SITE_OC_ROOT}core/img/actions/(logout|menu|more|play|search-white|settings|share|star|toggle-filelist|toggle-pictures|triangle-n|triangle-s|view-download)\.svg$",
            "^%{SITE_OC_ROOT}core/img/actions/checkbox-checked-disabled\.svg$",
            "^%{SITE_OC_ROOT}core/img/default-app-icon\.svg$",
            "^%{SITE_OC_ROOT}core/img/favicon-touch\.png$",
            "^%{SITE_OC_ROOT}core/img/favicon\.ico$",
            "^%{SITE_OC_ROOT}core/img/filetypes/(application|application-pdf|file|folder|folder-external|image|package-x-generic|text|text-code|x-office-document|package-x-generic|video|x-office-presentation|x-office-spreadsheet)\.(png|svg)$",
            "^%{SITE_OC_ROOT}core/img/places/(contacts-dark|files|home)\.svg$",
            "^%{SITE_OC_ROOT}core/img/rating/s%{INT}\.(png|svg)$",
            "^%{SITE_OC_ROOT}core/js/(apps|avatar|compatability|config|eventsource|jquery\.avatar|jquery\.ocdialog|js|l10n|login|lostpassword|mimetype|mimetypelist)\.js$",
            "^%{SITE_OC_ROOT}core/js/(compatibility|tags)\.js$",
            "^%{SITE_OC_ROOT}core/js/(integritycheck-failed-notification|oc|sharedialogmailview)\.js$",
            "^%{SITE_OC_ROOT}core/js/(multiselect|oc-backbone-webdav|select2-toggleselect|setupchecks)\.js$",
            "^%{SITE_OC_ROOT}core/js/(oc-backbone|oc-dialogs|oc-requesttoken|octemplate|placeholders?|share|shareconfigmodel|sharedialogexpirationview|sharedialoglinkshareview|sharedialogresharerinfoview|sharedialogshareelistview|sharedialogview|shareitemmodel|visitortimezone)\.js$",
            "^%{SITE_OC_ROOT}core/js/files/(client|fileinfo)\.js$",
            "^%{SITE_OC_ROOT}core/js/systemtags/systemtag(model|s|scollection|sinputfield|smappingcollection)\.js$",
            "^%{SITE_OC_ROOT}core/js/update\.js$",
            "^%{SITE_OC_ROOT}core/preview\.png$",
            "^%{SITE_OC_ROOT}core/search/js/search\.js$",
            "^%{SITE_OC_ROOT}core/search/templates/part\.results\.html$",
            "^%{SITE_OC_ROOT}core/templates/message\.html$",
            "^%{SITE_OC_ROOT}core/vendor/[-\w_/]+/([-\w./]+/)?[-\w.]+\.(css|js)$",
            "^%{SITE_OC_ROOT}core/vendor/backbone/backbone\.js$",
            "^%{SITE_OC_ROOT}core/vendor/blueimp-md5/js/md5\.js$",
            "^%{SITE_OC_ROOT}core/vendor/bootstrap/js/tooltip\.js$",
            "^%{SITE_OC_ROOT}core/vendor/davclient\.js/lib/client\.js$",
            "^%{SITE_OC_ROOT}core/vendor/handlebars/handlebars\.js$",
            "^%{SITE_OC_ROOT}core/vendor/jquery-migrate/jquery-migrate\.min\.js$",
            "^%{SITE_OC_ROOT}core/vendor/jquery-ui/themes/base/images/ui-icons_%{BASE16NUM}_%{INT}x%{INT}\.png$",
            "^%{SITE_OC_ROOT}core/vendor/jquery-ui/themes/base/jquery-ui\.css$",
            "^%{SITE_OC_ROOT}core/vendor/jquery-ui/ui/jquery-ui\.custom\.js$",
            "^%{SITE_OC_ROOT}core/vendor/jquery/dist/jquery\.min\.map$",
            "^%{SITE_OC_ROOT}core/vendor/jquery/jquery\.min\.js$",
            "^%{SITE_OC_ROOT}core/vendor/jsTimezoneDetect/jstz\.js$",
            "^%{SITE_OC_ROOT}core/vendor/moment/min/moment-with-locales\.js$",
            "^%{SITE_OC_ROOT}core/vendor/select2/select2\.png$",
            "^%{SITE_OC_ROOT}core/vendor/snapjs/dist/latest/snap\.js$",
            "^%{SITE_OC_ROOT}core/vendor/underscore/underscore\.js$",
            "^%{SITE_OC_ROOT}core/vendor/zxcvbn/zxcvbn\.js$"
          ] }
        }
      } else if [http][request][path] =~ /^\/owncloud\/index\.php/ {
        grok {
          patterns_dir => [ "/etc/logstash/patterns.d/" ]
          tag_on_failure => [ ]
          add_tag => [ "Known Message", "Benign" ]
          match => { "[http][request][path]" => [
            "^%{SITE_OC_ROOT}index\.php$",
            "^%{SITE_OC_ROOT}index\.php/apps/activity/$",
            "^%{SITE_OC_ROOT}index\.php/apps/activity/activities/fetch$",
            "^%{SITE_OC_ROOT}index\.php/apps/activity/api/v2/activity/all$",
            "^%{SITE_OC_ROOT}index\.php/apps/activity/api/v2/activity/filter$",
            "^%{SITE_OC_ROOT}index\.php/apps/announcementcenter/$",
            "^%{SITE_OC_ROOT}index\.php/apps/announcementcenter/announcement$",
            "^%{SITE_OC_ROOT}index\.php/apps/bookmarks/(bookmark/click|tag)?$",
            "^%{SITE_OC_ROOT}index\.php/apps/bookmarks/bookmark$",
            "^%{SITE_OC_ROOT}index\.php/apps/calendar/(ajax/cache/status\.php)?$",
            "^%{SITE_OC_ROOT}index\.php/apps/calendar/ajax/calendar/(activation|changeview|edit|update)(\.form)\.php$",
            "^%{SITE_OC_ROOT}index\.php/apps/calendar/ajax/event/(delete|edit|new)\.(form\.)?php$",
            "^%{SITE_OC_ROOT}index\.php/apps/calendar/ajax/events\.php$",
            "^%{SITE_OC_ROOT}index\.php/apps/calendar/ajax/settings/get(firstday|timezonedetection|timeformat)\.php$",
            "^%{SITE_OC_ROOT}index\.php/apps/calendar/ajax/settings/timeformat\.php$",
            "^%{SITE_OC_ROOT}index\.php/apps/calendar/export\.php$",
            "^%{SITE_OC_ROOT}index\.php/apps/calendar/js/idtype\.php$",
            "^%{SITE_OC_ROOT}index\.php/apps/calendar/js/l10n\.php$",
            "^%{SITE_OC_ROOT}index\.php/apps/calendar/v1/timezones/AMERICA/NEW_YORK\.ics$",
            "^%{SITE_OC_ROOT}index\.php/apps/calendar/v1/view$",
            "^%{SITE_OC_ROOT}index\.php/apps/contacts/$",
            "^%{SITE_OC_ROOT}index\.php/apps/contacts/addressbook/local/%{INT}/contact/(%{INT}|add)$",
            "^%{SITE_OC_ROOT}index\.php/apps/contacts/addressbook/local/%{INT}/contacts?(/%{INT}/photo)?$",
            "^%{SITE_OC_ROOT}index\.php/apps/contacts/addressbooks/$",
            "^%{SITE_OC_ROOT}index\.php/apps/contacts/ajax/config\.js$",
            "^%{SITE_OC_ROOT}index\.php/apps/contacts/connectors/%7Bbackend%7D$",
            "^%{SITE_OC_ROOT}index\.php/apps/contacts/groups/$",
            "^%{SITE_OC_ROOT}index\.php/apps/contacts/groups/addto/%{INT}$",
            "^%{SITE_OC_ROOT}index\.php/apps/contacts/preference/set$",
            "^%{SITE_OC_ROOT}index\.php/apps/documents/ajax/documents/list$",
            "^%{SITE_OC_ROOT}index\.php/apps/documents/ajax/mimes\.php$",
            "^%{SITE_OC_ROOT}index\.php/apps/documents/index$",
            "^%{SITE_OC_ROOT}index\.php/apps/external/ajax/setsites\.php$",
            "^%{SITE_OC_ROOT}index\.php/apps/files/?$",
            "^%{SITE_OC_ROOT}index\.php/apps/files/ajax/(list|scan|getstoragestats)\.php$",
            "^%{SITE_OC_ROOT}index\.php/apps/files/ajax/download\.php$",
            "^%{SITE_OC_ROOT}index\.php/apps/files/ajax/upload\.php$",
            "^%{SITE_OC_ROOT}index\.php/apps/files/api/v1/thumbnail/%{INT}/%{INT}/%{DATA:[files][src][filename]}$",
            "^%{SITE_OC_ROOT}index\.php/apps/files_external/globalstorages(/%{INT})?$",
            "^%{SITE_OC_ROOT}index\.php/apps/files_external/user(global)?storages(/%{INT})?$",
            "^%{SITE_OC_ROOT}index\.php/apps/files_pdfviewer/$",
            "^%{SITE_OC_ROOT}index\.php/apps/files_sharing/api/externalShares$",
            "^%{SITE_OC_ROOT}index\.php/apps/files_texteditor/ajax/loadfile$",
            "^%{SITE_OC_ROOT}index\.php/apps/files_texteditor/ajax/savefile$",
            "^%{SITE_OC_ROOT}index\.php/apps/files_versions/ajax/getVersions\.php$",
            "^%{SITE_OC_ROOT}index\.php/apps/gallery/$",
            "^%{SITE_OC_ROOT}index\.php/apps/gallery/config$",
            "^%{SITE_OC_ROOT}index\.php/apps/gallery/files/list$",
            "^%{SITE_OC_ROOT}index\.php/apps/gallery/preview/%{INT}$",
            "^%{SITE_OC_ROOT}index\.php/apps/gallery/slideshow$",
            "^%{SITE_OC_ROOT}index\.php/apps/gallery/thumbnails$",
            "^%{SITE_OC_ROOT}index\.php/apps/galleryplus/$",
            "^%{SITE_OC_ROOT}index\.php/apps/galleryplus/config$",
            "^%{SITE_OC_ROOT}index\.php/apps/galleryplus/config$",
            "^%{SITE_OC_ROOT}index\.php/apps/galleryplus/files/download/%{INT}$",
            "^%{SITE_OC_ROOT}index\.php/apps/galleryplus/files/list$",
            "^%{SITE_OC_ROOT}index\.php/apps/galleryplus/preview/%{INT}$",
            "^%{SITE_OC_ROOT}index\.php/apps/galleryplus/slideshow$",
            "^%{SITE_OC_ROOT}index\.php/apps/galleryplus/thumbnails$",
            "^%{SITE_OC_ROOT}index\.php/apps/music/$",
            "^%{SITE_OC_ROOT}index\.php/apps/music/api/album/%{INT}/cover$",
            "^%{SITE_OC_ROOT}index\.php/apps/music/api/collection$",
            "^%{SITE_OC_ROOT}index\.php/apps/music/api/scan$",
            "^%{SITE_OC_ROOT}index\.php/apps/ownnote/$",
            "^%{SITE_OC_ROOT}index\.php/apps/ownnote/ajax/v[0-9.]+/ajaxsetval$",
            "^%{SITE_OC_ROOT}index\.php/apps/ownnote/ajax/v[0-9.]+/ownnote/ajax(announcement|edit|index|save)$",
            "^%{SITE_OC_ROOT}index\.php/apps/ownnote/api/v[0-9.]+/ownnote/(mobileindex|version)$",
            "^%{SITE_OC_ROOT}index\.php/apps/user_ldap/ajax/(get|test)Configuration.php$",
            "^%{SITE_OC_ROOT}index\.php/apps/user_ldap/ajax/wizard\.php$",
            "^%{SITE_OC_ROOT}index\.php/avatar/%{USER_DST}/%{INT}$",
            "^%{SITE_OC_ROOT}index\.php/core/ajax/appconfig\.php$",
            "^%{SITE_OC_ROOT}index\.php/core/ajax/share\.php$",
            "^%{SITE_OC_ROOT}index\.php/core/js/oc\.js$",
            "^%{SITE_OC_ROOT}index\.php/core/preview\.png$",
            "^%{SITE_OC_ROOT}index\.php/displaynames$",
            "^%{SITE_OC_ROOT}index\.php/ocs/cloud/user$",
            "^%{SITE_OC_ROOT}index\.php/s/[A-Za-z0-9]+(/download)?$",
            "^%{SITE_OC_ROOT}index\.php/settings/(admin|help|personal)$",
            "^%{SITE_OC_ROOT}index\.php/settings/admin/log/entries$",
            "^%{SITE_OC_ROOT}index\.php/settings/admin/log/level$",
            "^%{SITE_OC_ROOT}index\.php/settings/ajax/(disableapp|enableapp|navigationdetect|uninstallapp|updateapp)\.php$",
            "^%{SITE_OC_ROOT}index\.php/settings/ajax/checksetup$",
            "^%{SITE_OC_ROOT}index\.php/settings/apps$",
            "^%{SITE_OC_ROOT}index\.php/settings/apps/(categories|list)$",
            "^%{SITE_OC_ROOT}index\.php/settings/integrity/failed$"
          ] }
        }
      }
    }
    if [files][dst][filename] {
      urldecode {
        field => "[files][dst][filename]"
      }
    }
  }
  if [type] == "owncloud" {
    if [http][request][path] =~ /\/notifications$/ and [message] == "Current user is not logged in" {
      mutate {
        add_tag => [ "Known Message", "Benign" ]
      }
    } 
    grok {
      tag_on_failure => [ ]
      add_tag => [ "Known Message" ]
      patterns_dir => [ "/etc/logstash/patterns.d/" ]
      match => { "message" => [
        "^\"%{DATA}\" is locked$",
        "^Count filter:  objectclass=\*$",
        "^File: %{PATH} modified since opening\.$",
        "^HTTP\/[12]\.[10] 401 No 'Authorization: Basic' header found. Either the client didn't send one, or the server is mis-configured$",
        "^HTTP\/[12]\.[10] 401 No basic authentication headers were found$",
        "^HTTP\/[12]\.[10] 423 \"[0-9a-zA-Z_. -]+\" is locked$",
        "^HTTP\/[12]\.[10] 503 System in maintenance mode.$",
        "^No update found at the ownCloud appstore for app %{POSINT}$",
        "^starting upgrade from [0-9.]+ to [0-9/]+$"
      ] }
    }
    grok {
      tag_on_failure => [ ]
      add_tag => [ "Known Message", "Error" ]
      patterns_dir => [ "/etc/logstash/patterns.d/" ]
      match => { "message" => [
        "^App directory already exists$",
        "^Attempt for Paging\?  $",
        "^Bind failed: 49: Invalid credentials$",
        "^CSRF check failed$",
        "^Cannot modify header information - headers already sent by \(output started at %{DATA}\.php:%{INT}\) at %{DATA}\.php#%{INT}$",
        "^Client error response \[url\] https://apps.owncloud.com/CONTENT/content-files/%{DATA}\.(tar\.gz|zip) \[status code\] 400 \[reason phrase\] Bad Request$",
        "^Could not get applications: cURL error 28: Operation timed out after %{POSINT} milliseconds( with %{POSINT} out of %{INT} bytes received)?$",
        "^Could not read app info file for app \"%{WORD}\"$",
        "^Current user is not logged in$",
        "^Error when searching: Can't contact LDAP server code -1$",
        "^Failed to connect to the database: An exception occured in driver: SQLSTATE\[HY000\] \[2005\] Unknown MySQL server host \'%{IP_DST}\' \(2\)$",
        "^HTTP\/[12]\.[10] 400 The {DAV:}property-search element must contain one {DAV:}match and one {DAV:}prop element$",
        "^HTTP\/[12]\.[10] 400 expected filesize %{INT} got %{INT}$",
        "^HTTP\/[12]\.[10] 401 Username or password (was incorrect|does not match)$",
        "^HTTP\/[12]\.[10] 403 Requested uri \(%{DATA}\) is out of base uri \(%{DATA}\)",
        "^HTTP\/[12]\.[10] 404 File with name %{DATA:[files][dst][filename]} could not be located$",
        "^HTTP\/[12]\.[10] 405 The resource you tried to create already exists$",
        "^HTTP\/[12]\.[10] 409 Parent node does not exist$",
        "^HTTP\/[12]\.[10] 412 The destination node already exists, and the overwrite header is set to false$",
        "^HTTP\/[12]\.[10] 500 Could not write file contents$",
        "^HTTP\/[12]\.[10] 501 There was no handler found for this \"LOCK\" method$",
        "^HTTP\/[12]\.[10] 503 Doctrine\\DBAL\\DBALFailed to connect to the database: An exception occured in driver: SQLSTATE\[HY000\] \[2005\] Unknown MySQL server host \'%{IP_DST}\' \(2\)$",
        "^HTTP\/[12]\.[10] 503 OC\\ServerNotAvailableLost connection to LDAP server\.$",
        "^HTTP\/[12]\.[10] 507 Insufficient Storage$",
        "^LDAP error Invalid credentials \(49\) after calling ldap_bind$",
        "^Login failed: \'%{USER_DST}\' \(Remote IP: \'%{IP_SRC}\'\)$",
        "^Lost connection to LDAP server\.$",
        "^No user available for the given login name on %{URI}$",
        "^Not in batch$",
        "^OCA\\Contacts\\Backend\\Database::getContact, Not found, id: %{INT}$",
        "^can\'t remove app %{DATA}\. It is not installed\.$",
        "^fclose\(\) expects parameter %{INT} to be resource, boolean given at %{DATA}\.php#%{INT}$",
        "^filesize\(\): stat failed for %{DATA} at %{DATA}\.php#%{INT}$",
        "^fopen\(%{DATA}\): failed to open stream: No such file or directory at %{DATA}\.php#%{INT}$",
        "^fread\(\) expects parameter %{INT} to be resource, boolean given at %{DATA}\.php#%{INT}$",
        "^updateByPath - file not found - %{DATA:[files][dst][filename]}$"
      ] }
    }
    grok {
      patterns_dir => [ "/etc/logstash/patterns.d/" ]
      tag_on_failure => [ ]
      add_tag => [ "Known Message", "Benign" ]
      match => { "message" => [
        "(m?)^initializing paged search for  ?Filter (objectClass=\*|(\(&)?\(&\(\|\(objectclass=nestedgroup\)\)\(\|(\((cn|uid)=%{DATA}\))+\)\)(\(cn=\*\))?)(\))? base Array\n\(\n\s+\[0\] => ((cn|uid)=%{DATA},)?cn=(groups|users),cn=accounts,%{SITE_LDAP_BASE}\n\)\n attr Array\n\(\n(\s+\[\d\] => %{OC_LDAP_USER_ATTRS}\n)+\)\n limit (500|2) offset 0$",
        "^(Run|Finished) job with ID \d+$",
        "^Accessing the API class is deprecated\! Use the appropriate services instead\!$",
        "^Count filter: objectclass=*$",
        "^Expire: %{DATA:[files][dst][filename]}\.v%{INT:[files][dst][version]}$",
        "^Generating preview for \".+\" with \"OC\\Preview\\\w+\"$",
        "^Invalidating tokens older than %{TIMESTAMP_ISO8601}$",
        "^Looking for cookie L/O 500/0$",
        "^Mark to expire %{DATA:[files][dst][filename]} next version should be %{INT} or smaller\. \(prevTimestamp: %{INT}; step: %{INT}$",
        "^More than one result$",
        "^No DN found for.* on %{URI}",
        "^No paged search for us, Cpt., Limit %{INT} Offset %{INT}$",
        "^OCA\\Contacts\\Contact::setPropertyByChecksum adding: TEL( [0-9(). -]+)?$",
        "^OCA\\Contacts\\Contact::setPropertyByName adding: (FN|NOTE) .*$",
        "^OCA\\Contacts\\Hooks::contactAdded id: %{INT}$",
        "^OCA\\Contacts\\Utils\\Properties::purgeIndexes, ids: Array$",
        "^OCA\\Contacts\\Utils\\Properties::purgeIndexes, ids: Array\n\(\n   \[0\] => \d+\n\)",
        "^OC_Image->fixOrientation\(\) (Orientation: -?\d+|Image is not a JPEG\.)$",
        "^Paged search was not available$",
        "^Ready for a paged search$",
        "^Requested attribute ",
        "^Requested attribute (displayname|thumbnailphoto|jpegphoto|mail|primarygroupid) not found for uid=%{USER_DST},cn=users,cn=accounts,%{SITE_LDAP_BASE}$",
        "^Requested attribute (memberof) not found for cn=%{USER_DST},cn=groups,cn=accounts%{SITE_LDAP_BASE}$",
        "^Requested attribute .* not found for cn=.*%{SITE_LDAP_BASE}$",
        "^Rescan triggered$",
        "^Run background job \"updateGroups\"$",
        "^Secured pdf file are currently not supported\.",
        "^Undefined offset: %{INT} at /var/www/html/owncloud/apps/music/businesslayer/albumbusinesslayer\.php#77$",
        "^\d+ orphaned ((user|system) tag relations|comments|read marks) deleted$",
        "^\d+ orphaned comment read marks deleted$",
        "^\d+ orphaned share\(s\) deleted$",
        "^adding \d+ {\"boost\":1}$",
        "^background job (indexing \d+ files|optimizing index) for %{USER_DST}$",
        "^bgJ \"updateGroups\" – (FINISHED )?[dD]ealing with ((creat|remov)ed|known) [gG]roups\.$",
        "^bgJ \"updateGroups\" – Finished\.$",
        "^delete - \d+$",
        "^extracted metadata - artist: %{DATA}, album: audiodata, title: %{DATA}, track#: %{INT}?, year: %{INT}?, mimetype: %{DATA}, length: %{INT}, bitrate: %{INT}, fileId: %{DATA}?, this-\>userId: %{USER_DST}, userId: %{USER_DST}$",
        "^found \d+ hits for file id [ #.a-zA-Z0-9_+/-]+$",
        "^getGroups Filter (objectClass=\*|(\(&)?\(&\(\|\(objectclass=nestedgroup\)\)\(\|(\(cn=%{DATA}\))+\)\)(\(cn=\*\))?)(\))?$",
        "^getGroups getGroups--500-0$",
        "^getGroups\(\): read \d+ at offset \d+ \(limit: 500\)$",
        "^getUsers: Options: search  limit 500 offset (500)? Filter: \(&\(&\(|\(objectclass=inetorgperson\)\)\(|\(memberof=cn=%{USERNAME:group_dst},cn=groups,cn=accounts,%{SITE_LDAP_BASE}\)\)\)\(displayname=\*\)\(displayname=\*\)\)$",
        "^getUsers: \d+ Users found$",
        "^initializing paged search for",
        "^max(X|Y) reduced from \d+ to \d+$",
        "^optimizing index$",
        "^readAttribute: ",
        "^readAttribute: cn=%{USERNAME:group_dst},cn=groups,cn=accounts,%{SITE_LDAP_BASE} found$",
        "^readAttribute: uid=%{USER_DST},cn=users,cn=accounts,%{SITE_LDAP_BASE} found$",
        "^removed \d+ files from index$",
        "^removed entities - albums: \[\], artists: \[\]$",
        "^removing \d+:[ #.a-zA-Z0-9_+/-]+ from index$",
        "^update - [ #.a-zA-Z0-9_+/%-]+$",
        "^update - mimetype [a-zA-Z0-9-]+/[a-zA-Z0-9-]+$"
      ] }
    }
  }
  if [syslog][identifier] == "CROND" and [message] =~ /owncloud\/cron.php\)$/ {
    grok {
      patterns_dir => [ "/etc/logstash/patterns.d/" ]
      tag_on_failure => [ ]
      add_tag => [ "Known Message", "Benign" ]
      add_field => { "application" => "owncloud" }
      match => { "message" => [ "^\(apache\) CMD \(/opt/rh/rh-php56/root/usr/bin/php -f /var/www/html/owncloud/cron\.php\)$",
                                "^\(apache\) CMD \(/usr/bin/php -f /var/www/html/owncloud/cron\.php\)$"
      ] }
    }
  }
}
