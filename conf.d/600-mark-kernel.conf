filter { 
  if [type] == "syslog" or [type] == "cee" and [syslog][identifier] == "kernel" { 
    grok { 
      tag_on_failure => [ ] 
      add_tag => [ "Known Message" ] 
      match => { "message" => [ 
        "^\[\s*\d+\.\d+\] Atheros AR8216/AR8236/AR8316 ag71xx-mdio\.0:00: Port \d+ is (up|down)"
      ] } 
    } 
    grok { 
      patterns_dir => [ "/etc/logstash/patterns.d/" ] 
      tag_on_failure => [ ] 
      add_tag => [ "Known Message", "Benign"] 
      match => { "message" => [ 
        "^%{WORD} [0-9:]+:%{WORD} : %{INTF_DST} NIC Link is (Down|Up\<100?0? Mbps Full Duplex\>)$",
        "^%{WORD}: port %{INT}\(%{INTF_DST}\) entered (disabled|forwarding) state$",
        "^CPU%{INT}: Core temperature/speed normal$",
        "^Deactivating swap %{PATH}\.\.\.$",
        "^Ebtables v2\.0 (un)?registered$",
        "^IPv6: ADDRCONF\(NETDEV_(CHANGE|UP)\): %{INTF_SRC}: link (becomes|is not) ready$",
        "^SELinux: initialized \(dev (devpts|dm-%{INT}|mqueue|proc|sysfs|tmpfs), type (devpts|mqueue|proc|sysfs|tmpfs|xfs)\), uses ((genfs_contexts|labeling|mountpoint|transition SIDs|xattr) ?)+$",
        "^XFS \(dm-%{INT}\): (Ending clean mount|Mounting V4 Filesystem|Unmounting Filesystem)$",
        "^nf_conntrack version 0\.5\.0 \(%{INT} buckets, %{INT} max\)$"
      ] }
    } 
    grok { 
      tag_on_failure => [ ] 
      add_tag => [ "Known Message", "Error"] 
      match => { "message" => [ 
        "^CPU%{INT}: Core temperature above threshold, cpu clock throttled \(total events = %{INT}\)$",
        "^device-mapper: thin: Deletion of thin device %{POSINT} failed\.$",
        "^sd %{INT}:%{INT}:%{INT}:%{INT}: \[sda\] abort$"
      ] }
    } 
    grok { 
      patterns_dir => [ "/etc/logstash/patterns.d/" ] 
      tag_on_failure => [ ] 
      add_tag => [ "Known Message", "Alert"] 
      match => { "message" => [ 
        "^device veth%{BASE16NUM} entered promiscuous mode$",
        "^device %{INTF_SRC} (enetered|left) promiscuous mode$"
      ] }
    } 
  }
}
