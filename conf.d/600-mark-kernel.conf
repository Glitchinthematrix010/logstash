filter { 
  if [type] == "syslog" or [type] == "cee" and [syslog][identifier] == "kernel" { 
    grok { 
      tag_on_failure => [ ] 
      add_tag => [ "Known Message" ] 
      match => { "message" => [ 
        "^\[\s*\d+\.\d+\] Atheros AR8216/AR8236/AR8316 ag71xx-mdio\.0:00: Port \d+ is (up|down)"
      ] } 
    } 
    grok { 
      patterns_dir => [ "/etc/logstash/patterns.d/" ] 
      tag_on_failure => [ ] 
      add_tag => [ "Known Message", "Benign"] 
      match => { "message" => [ 
        "^%{IPTABLES}$",
        "^%{AUDIT} %{AUDITSYSTEMD}$",
        "^%{AUDIT} audit_pid=%{INT} old=%{INT} auid=%{INT} ses=%{INT} subj=system_u:system_r:auditd_t:s%{INT} res=%{INT}$",
        "^%{AUDIT} enforcing=%{INT} old_enforcing=%{INT} auid=%{INT} ses=%{INT}$",
        "^%{AUDIT} initialized$",
        "^%{AUDIT} policy loaded auid=%{INT} ses=%{INT}$",
        "^%{BASE16NUM}-%{BASE16NUM} (uncachable|write-back|write-protect)$",
        "^%{INTF_SRC}: [14]0+ Mbps (Full|Half) duplex, port %{INT}$",
        "^%{INTF_SRC}: Link down$",
        "^%{NOTSPACE} %{PCIDEV}: PCI INT [ABCD] -> Link\[LNK\w\] -> GSI %{INT} \(level, high\) -> IRQ %{INT}$",
        "^%{NOTSPACE} %{PCIDEV}: irq %{INT} for MSI\/MSI-X$",
        "^%{NOTSPACE} %{PCIDEV}: new USB bus registered, assigned bus number %{INT}$",
        "^%{NOTSPACE} %{PCIDEV}: setting latency timer to %{INT}$",
        "^%{NOTSPACE} %{PCIDEV} %{INTF_SRC}: %{NOTSPACE}: %{NOTSPACE} NIC Link is Down$",
        "^%{NOTSPACE} %{PCIDEV} %{INTF_SRC}: %{NOTSPACE}: %{NOTSPACE} NIC Link is Up [14]0+ Mbps (Full|Half) Duplex(, Flow Control: RX/TX)?$",
        "^%{DATA}: module loaded$",
        "^%{INT} base %{BASE16NUM} mask %{BASE16NUM} uncachable$",
        "^%{INT} disabled$",
        "^%{PNPBASE}: Plug and Play ACPI device, IDs PNP[0-9a-f]{2}[0-9a-f]{2} \(active\)$",
        "^%{PNPBASE}: \[dma %{INT}\]$",
        "^%{POSINT} pages (RAM|reserved)$",
        "^%{POSINT} total pagecache pages$",
        "^%{POSINT} pages in swap cache$",
        "^%{NOTSPACE}: port %{INT}\(%{INTF_DST}\) entered (disabled|forwarding) state$",
        "^(Dentry cache|Dquot-cache|futex|Inode-cache|Mount-cache|PID|TCP (bind|established)|UDP(-Lite)?) hash table entries: %{INT} ?( \(order:? %{INT}, %{INT} bytes\))?$",
        "^(Dis|En)abling non-boot CPUs \.\.\.$",
        "^(Free|Total) swap  ?= %{INT}kB$",
        "^(mice|mousedev): PS/2 mouse device common for all mice$",
        "^ACPI Exception: AE_NOT_FOUND, While evaluating Sleep State \[\\_S%{INT}_\] \(%{INT}/hwxface-%{INT}\)$",
        "^ACPI: (APIC|DSDT|FACP|RSDT|SRAT|SSDT) %{BASE16NUM} %{BASE16NUM} \(v01 BOCHS  BXPC(APIC|DSDT|FACP|RSDT|SRAT|SSDT) %{BASE16NUM} BXPC %{BASE16NUM}\)$",
        "^ACPI: (Preparing to enter|Waking up from) system sleep state S%{INT}$",
        "^ACPI: ACPI bus type pnp unregistered$",
        "^ACPI: Added _OSI\((Module|Processor( Aggregator)?) Device\)$",
        "^ACPI: Added _OSI\([0-9.]+ _SCP Extensions\)$",
        "^ACPI: All ACPI Tables successfully acquired$",
        "^ACPI: Core revision %{INT}$",
        "^ACPI: EC: Look up EC in DSDT$",
        "^ACPI: Enabled %{INT} GPEs in block %{BASE16NUM} to %{BASE16NUM}$",
        "^ACPI: FACS %{BASE16NUM} %{BASE16NUM}$",
        "^ACPI: INT_SRC_OVR \(bus %{INT} bus_irq %{INT} global_irq %{INT} (dfl dfl|high level)\)$",
        "^ACPI: IOAPIC \(id\[%{BASE16NUM}\] address\[%{BASE16NUM}\] gsi_base\[%{BASE16NUM}\]\)$",
        "^ACPI: IRQ%{INT} used by override\.$",
        "^ACPI: Interpreter enabled$",
        "^ACPI: LAPIC \(acpi_id\[%{BASE16NUM}\] lapic_id\[%{BASE16NUM}\] (en|dis)abled\)$",
        "^ACPI: LAPIC_NMI \(acpi_id\[%{BASE16NUM}\] dfl dfl lint\[%{BASE16NUM}\]\)$",
        "^ACPI: Local APIC address %{BASE16NUM}$",
        "^ACPI: Low-level resume complete$",
        "^ACPI: No dock devices found\.$",
        "^ACPI: PCI Interrupt Link \[LNK\w\] \(IRQs (\*?%{INT} ?)+\)$",
        "^ACPI: PCI Interrupt Link \[LNK\w\] enabled at IRQ %{INT}$",
        "^ACPI: PCI Interrupt Routing Table \[\\_SB_\.PCI%{INT}\._PRT\]$",
        "^ACPI: PCI Root Bridge \[PCI%{INT}\] \(domain [0-9a-f]{4} \[bus [0-9a-f][0-9a-f]-[0-9a-f][0-9a-f]\]\)$",
        "^ACPI: PM-Timer IO Port: %{BASE16NUM}$",
        "^ACPI: Power Button \[PWRF\]$",
        "^ACPI: RSDP %{BASE16NUM} %{BASE16NUM} \(v%{INT} BOCHS \)$",
        "^ACPI: Using IOAPIC for interrupt routing$",
        "^ACPI: \(supports (S%{INT} ?)+\)$",
        "^ACPI: acpi_idle registered with cpuidle$",
        "^ACPI: bus type (PCI|PNP|USB) (un)?registered$",
        "^ACPI: bus type p(ci|np) registered$",
        "^AGP: Checking aperture\.\.\.$",
        "^AGP: No AGP bridge found$",
        "^Adding %{INT}k swap on %{FILENAME_SRC}\.  Priority:%{INT} extents:%{INT} across:%{INT}k( FS)?$",
        "^Asymmetric key parser 'x509' registered$",
        "^BIOS-e820: \[mem %{BASE16NUM}-%{BASE16NUM}\] (usable|reserved)$",
        "^BRK \[%{BASE16NUM}, %{BASE16NUM}\] PGTABLE$",
        "^Base memory trampoline at \[%{BASE16NUM}] %{BASE16NUM} size %{INT}$",
        "^Block layer SCSI generic \(bsg\) driver version [0-9.]+ loaded \(major %{INT}\)$",
        "^Bluetooth: Core ver [0-9.]+$",
        "^Bluetooth: HCI device and connection manager initialized$",
        "^Bluetooth: HCI socket layer initialized$",
        "^Booting paravirtualized kernel on KVM$",
        "^Bridge firewalling registered$",
        "^Broke affinity for irq %{INT}$",
        "^Brought up %{INT} CPUs$",
        "^Built %{INT} zonelists in Node order, mobility grouping on\.  Total pages: %{INT}$",
        "^CPU%{INT} is up$",
        "^CPU%{INT}: Core temperature/speed normal$",
        "^CPU\s+%{INT}: hi:\s+%{INT}, btch:\s+%{INT} usd:\s+%{INT}$",
        "^Calibrating delay loop \(skipped\) preset value\.\. %{BASE10NUM} BogoMIPS \(lpj=%{BASE16NUM}\)$",
        "^Command line: %{DATA}$",
        "^Console: colour VGA\+ %{INT}x%{INT}$",
        "^Console: switching to colour frame buffer device %{INT}x%{INT}$",
        "^DCCP: Activated CCID 2 \(TCP-like\)$",
        "^DCCP: Activated CCID 3 \(TCP-Friendly Rate Control\)$",
        "^DMA(32)?\s+\[mem %{BASE16NUM}-%{BASE16NUM}\]$",
        "^DMI: oVirt oVirt Node, BIOS seabios-[0-9.]+-\d+\.el\d+ \d{2}/\d{2}/\d{4}$",
        "^Deactivating swap %{PATH}\.\.\.$",
        "^EVM: security\.(capability|ima|selinux)$",
        "^EXT4-fs \(%{DATA}\): %{INT} orphan inodes deleted$",
        "^EXT4-fs \(%{DATA}\): INFO: recovery required on readonly filesystem$",
        "^EXT4-fs \(%{DATA}\): ext4_orphan_cleanup: deleting unreferenced inode %{INT}$",
        "^EXT4-fs \(%{DATA}\): mounted filesystem with ordered data mode. Opts:$",
        "^EXT4-fs \(%{DATA}\): orphan cleanup on readonly fs$",
        "^EXT4-fs \(%{DATA}\): recovery complete$",
        "^EXT4-fs \(%{DATA}\): write access will be enabled during recovery$",
        "^Early memory node ranges$",
        "^Ebtables v2\.0 (un)?registered$",
        "^Enabl(ed|ing) x2apic$",
        "^FDC %{INT} is a S82078B$",
        "^Fixed MDIO Bus: probed$",
        "^Freeing initrd memory: %{INT}k freed$",
        "^Freeing unused kernel memory: %{INT}k freed$",
        "^Freezing (remaining freezable tasks|user space processes) \.\.\. \(elapsed %{BASE10NUM} seconds\) done\.$",
        "^GHES: HEST is not enabled\!$",
        "^GRE over IPv4 demultiplexor driver$",
        "^Hardware name: %{DATA}$",
        "^Hierarchical RCU implementation\.$",
        "^HugeTLB registered %{INT} MB page size, pre-allocated %{INT} pages$",
        "^Hypervisor detected: KVM$",
        "^IMA: No TPM chip found, activating TPM-bypass\!$",
        "^IOAPIC\[%{INT}\]: apic_id %{INT}, version %{INT}, address %{BASE16NUM}, GSI %{INT}-%{INT}$",
        "^IPv6: ADDRCONF\(NETDEV_(CHANGE|UP)\): %{INTF_SRC}: link (becomes|is not) ready$",
        "^Initalizing network drop monitor service$",
        "^Initialise system trusted keyring$",
        "^Initializing XFRM netlink socket$",
        "^Initializing cgroup subsys (blkio|cpu(set|acct)?|devices|freezer|hugetlb|memory|net_cls|perf_event)$",
        "^Initmem setup node %{INT} \[mem %{BASE16NUM}-%{BASE16NUM}\]$",
        "^Installing knfsd \(copyright \(C\) 1996 okir@monad\.swb\.de\)\.$",
        "^KVM setup async PF for cpu %{INT}$",
        "^KVM setup paravirtual spinlock$",
        "^Kernel command line: %{DATA}$",
        "^Key type (asymmetric|big_key|encrypted|trusted) registered$",
        "^Last level iTLB entries: 4KB %{INT}, 2MB %{INT}, 4MB %{INT}$",
        "^Linux agpgart interface v[0-9.]+$",
        "^Linux version %{DATA}$",
        "^Loaded X.509 cert 'CentOS Linux (kernel|kpatch|Driver update) signing key: [a-f0-9]{40}'$",
        "^Loading compiled-in X\.509 certificates$",
        "^MTRR default type: write-back$",
        "^MTRR fixed ranges enabled:$",
        "^MTRR variable ranges enabled:$",
        "^Memory: %{INT}k/%{INT}k available \(%{INT}k kernel code, %{INT}k absent, %{INT}k reserved, %{INT}k data, %{INT}k init\)$",
        "^Movable zone start for each node$",
        "^NET: Registered protocol family (1|2|10|16|17|31|38)$",
        "^NMI watchdog: disabled \(cpu%{INT}\): hardware events not enabled$",
        "^Node %{INT} DMA(32)? per-cpu:$",
        "^Node %{INT} DMA(32)?: %{INT}\*4kB \(UER\) %{INT}\*8kB \(UER\) %{INT}\*16kB \(UEMR\) %{INT}\*32kB \(MR\) %{INT}\*64kB \(R\) %{INT}\*128kB \(R\) %{INT}\*256kB \(R\) %{INT}\*512kB \(R\) %{INT}\*1024kB \(R\) %{INT}\*2048kB \(R\) %{INT}\*4096kB = %{INT}kB$",
        "^Node %{INT} hugepages_total=%{INT} hugepages_free=%{INT} hugepages_surp=%{INT} hugepages_size=2048kB$",
        "^Node %{INT} DMA(32)?: (%{INT}\*(4|8|16|32|64|128|256|512|1024|2048|4096)kB (\([EMRU]+\) )?)+= %{INT}kB$",
        "^Node %{INT} DMA(32)? free:%{INT}kB min:%{INT}kB low:%{INT}kB high:%{INT}kB active_anon:%{INT}kB inactive_anon:%{INT}kB active_file:%{INT}kB inactive_file:%{INT}kB unevictable:%{INT}kB isolated\(anon\):%{INT}kB isolated\(file\):%{INT}kB present:%{INT}kB managed:%{INT}kB mlocked:%{INT}kB dirty:%{INT}kB writeback:%{INT}kB mapped:%{INT}kB shmem:%{INT}kB slab_reclaimable:%{INT}kB slab_unreclaimable:%{INT}kB kernel_stack:%{INT}kB pagetables:%{INT}kB unstable:%{INT}kB bounce:%{INT}kB free_cma:%{INT}kB writeback_tmp:%{INT}kB pages_scanned:%{INT} all_unreclaimable\? (yes|no)$",
        "^NR_IRQS:%{INT} nr_irqs:%{INT} %{INT}$",
        "^NUMA: Node %{INT} \[mem %{BASE16NUM}-%{BASE16NUM}\] \+ \[mem %{BASE16NUM}-%{BASE16NUM}\] -> \[mem %{BASE16NUM}-%{BASE16NUM}\]$",
        "^NX \(Execute Disable\) protection: active$",
        "^NetLabel:  domain hash size = %{INT}$",
        "^NetLabel:  protocols = UNLABELED CIPSOv4$",
        "^NetLabel:  unlabeled traffic allowed by default$",
        "^NetLabel: Initializing$",
        "^Non-volatile memory driver v[0-9.]+$",
        "^Normal   empty$",
        "^On node %{INT} totalpages: %{INT}$",
        "^PCI host bridge to bus %{PCIBUS}$",
        "^PCI: CLS %{INT} bytes, default %{INT}$",
        "^PCI: Using ACPI for IRQ routing$",
        "^PCI: Using configuration type %{INT} for base access$",
        "^PCI: Using host bridge windows from ACPI; if necessary, use \"pci=nocrs\" and report a bug$",
        "^PCI: pci_cache_line_size set to %{INT} bytes$",
        "^PERCPU: Embedded %{INT} pages/cpu @%{BASE16NUM} (\S+ ?)+$",
        "^PM: (Restor|Sav)ing platform NVS memory$",
        "^PM: (Suspending system|Preparing system for sleep) \(mem\)$",
        "^PM: (early|late|noirq) (resume|suspend) of devices complete after %{BASE10NUM} msecs$",
        "^PM: (resume|suspend) of devices complete after %{BASE10NUM} msecs$",
        "^PM: Finishing wakeup\.$",
        "^PM: Registered nosave memory: \[mem %{BASE16NUM}-%{BASE16NUM}\]$",
        "^PM: Syncing filesystems \.\.\. done\.$",
        "^PPP MPPE Compression module registered$",
        "^PPP generic driver version [0-9.]+$",
        "^Performance Events: unsupported p6 CPU model %{INT} no PMU driver, software events only\.$",
        "^Policy zone: DMA(32)?$",
        "^RAMDISK: \[mem %{BASE16NUM}-%{BASE16NUM}\]$",
        "^RPC: Registered (named UNIX socket|tcp NFSv4\.1 backchannel|(tc|ud)p) transport module.$",
        "^Refined TSC clocksource calibration: %{BASE10NUM} MHz\.$",
        "^Restarting tasks \.\.\. done\.$",
        "^SCSI subsystem initialized$",
        "^SELinux:  %{INT} classes, %{INT} rules$",
        "^SELinux:  %{INT} users, %{INT} roles, %{INT} types, %{INT} bools, %{INT} sens, %{INT} cats$",
        "^SELinux:  Completing initialization\.$",
        "^SELinux:  Disabled at runtime.$",
        "^SELinux:  Initializing\.$",
        "^SELinux:  Permission validate_trans in class security not defined in policy.$",
        "^SELinux:  Registering netfilter hooks$",
        "^SELinux:  Setting up existing superblocks\.$",
        "^SELinux:  Starting in permissive mode$",
        "^SELinux:  Unregistering netfilter hooks$",
        "^SELinux: %{INT} (avtab hash slots|classes), %{INT} rules\.?$",
        "^SELinux: initialized \(dev %{SELINUXTYPE}, type %{SELINUXTYPE}\), (uses ((genfs_contexts|labeling|mountpoint|(task|transition) SIDs|xattr) ?)+|not configured for labeling)$",
        "^SELinux: the above unknown classes and permissions will be allowed$",
        "^SGI XFS with ACLs, security attributes, no debug enabled$",
        "^SLUB: HWalign=%{INT}, Order=%{INT}-%{INT}, MinObjects=%{INT}, CPUs=%{INT}, Nodes=%{INT}$",
        "^SMBIOS [0-9.]+ present\.$",
        "^SRAT: Node %{INT} PXM %{INT} \[mem %{BASE16NUM}-%{BASE16NUM}\]( hotplug)?$",
        "^SRAT: PXM %{INT} -> APIC %{BASE16NUM} -> Node %{INT}$",
        "^Security Framework initialized$",
        "^Serial: 8250/16550 driver, %{INT} ports, IRQ sharing enabled$",
        "^Suspending console\(s\) \(use no_console_suspend to debug\)$",
        "^Swap cache stats: add %{INT}, delete %{INT}, find %{INT}\/%{INT}$",
        "^Switched APIC routing to physical x2apic\.$",
        "^Switching to clocksource kvm-clock$",
        "^TCP: (cubic|reno) registered$",
        "^TCP: Hash tables configured \(established %{INT} bind %{INT}\)$",
        "^Uniform CD-ROM driver Revision: [0-9.]+$",
        "^Unpacking initramfs\.\.\.$",
        "^Using ACPI \(MADT\) for SMP configuration information$",
        "^VFS: Disk quotas dquot_[0-9.]+$",
        "^XFS \(dm-%{INT}\): (Ending clean mount|Mounting V4 Filesystem|Unmounting Filesystem)$",
        "^XFS \(sd\w+\d\): (Mounting V4|Unmounting) Filesystem$",
        "^XFS \(sd\w+\d\): (Start|End)ing recovery \(logdev: internal\)$",
        "^XFS \(sd\w+\d\): Ending clean mount$",
        "^Zone ranges:$",
        "^[eou]hci(_hcd|-pci) [0-9a-f]+:[0-9a-f]+:d+\.\d+: System wakeup disabled by ACPI$",
        "^[eou]hci(_hcd|-pci): USB [123]\.[01] '%{DATA}' Host Controller \([EOU]HCI\) Driver$",
        "^[eou]hci-(hcd|pci): [EOU]HCI (PCI|HCD) platform driver$",
        "^[eou]hci[_-](hcd|pci) %{PCIDEV}: System wakeup (dis|en)abled by ACPI$",
        "^[eou]hci[_-](hcd|pci) %{PCIDEV}: detected %{INT} ports$",
        "^[eou]hci[_-](hcd|pci) %{PCIDEV}: irq %{INT}, io base %{BASE16NUM}$",
        "^[sv]d\w+: ([sv]d\w+\d ?)+$",
        "^\.\.TIMER: vector=%{BASE16NUM} apic1=%{INT} pin1=%{INT} apic2=%{INT} pin2=%{INT}$",
        "^ \[%{BASE16NUM}-%{BASE16NUM}\] PMD -> \[%{BASE16NUM}-%{BASE16NUM}\] on node %{INT}$",
        "^\[TTM\] Initializing (DMA )?pool allocator$",
        "^\[TTM\] Zone  kernel: Available graphics memory: %{INT} kiB$",
        "^\[drm\] %{INT} byte draw area at offset %{BASE16NUM}$",
        "^\[drm\] %{INT} io pages at offset %{BASE16NUM}$",
        "^\[drm\] Compression level %{INT} log level %{INT}$",
        "^\[drm\] Currently using mode #%{INT}, list at %{BASE16NUM}$",
        "^\[drm\] Device Version [0-9.]+$",
        "^\[drm\] Initialized drm [0-9.]+ %{INT}$",
        "^\[drm\] Initialized qxl [0-9.]+ %{INT} for %{PCIBUS}%{PCIDEV} on minor %{INT}$",
        "^\[drm\] Initialized qxl [0-9.]+ %{INT} for %{PCIDEV} on minor %{INT}$",
        "^\[drm\] No driver support for vblank timestamp query\.$",
        "^\[drm\] RAM header offset: %{BASE16NUM}$",
        "^\[drm\] Supports vblank timestamp caching Rev %{INT} \([0-9.]+\)\.$",
        "^\[drm\] fb mappable at %{BASE16NUM}, size %{INT}$",
        "^\[drm\] fb: depth %{INT}, pitch %{INT}, width %{INT}, height %{INT}$",
        "^\[drm\] main mem slot %{INT} \[%{BASE16NUM},%{BASE16NUM}\]$",
        "^\[drm\] qxl: %{INT}M of (Surface memory size|IO pages memory ready \(VRAM domain\))$",
        "^\[drm\] qxl: %{INT}M of VRAM memory size$",
        "^\[drm\] rom modes offset %{BASE16NUM} for %{INT} modes$",
        "^\[drm\] surface mem slot %{INT} \[%{BASE16NUM},%{BASE16NUM}\]$",
        "^\[mem %{BASE16NUM}-%{BASE16NUM}\] page (2M|4k)$",
        "^\[mem %{BASE16NUM}-%{BASE16NUM}\] page (4k|2M)$",
        "^\s+%{BASE16NUM}-%{BASE16NUM} (uncachable|write-protect)$",
        "^\s+%{BASE16NUM}-%{BASE16NUM} write-back$",
        "^\s+%{INT} base %{BASE16NUM} mask %{BASE16NUM} uncachable$",
        "^\s+%{INT} disabled$",
        "^\s+DMA(32)? zone: %{INT} pages (reserved|used for memmap| LIFO batch:%{INT})$",
        "^\s+DMA(32)? zone: %{INT} pages, LIFO batch:%{INT}$",
        "^\s+DMA(32)?\s+\[mem %{BASE16NUM}-%{BASE16NUM}\]$",
        "^\s+NODE_DATA \[mem %{BASE16NUM}-%{BASE16NUM}\]$",
        "^\s+Normal\s+empty$",
        "^\s+Offload RCU callbacks from( all)? CPUs(: %{INT}-%{INT}\.)?$",
        "^\s+RCU restricting CPUs from NR_CPUS=%{INT} to nr_cpu_ids=%{INT}\.$",
        "^\s+\[%{BASE16NUM}-%{BASE16NUM}\] PMD -> \[%{BASE16NUM}-%{BASE16NUM}\] on node 0$",
        "^\s+\[mem %{BASE16NUM}-%{BASE16NUM}\] page (2M|4k)$",
        "^\s+cache: parent cpu%{INT} should not be sleeping$",
        "^\s+node\s+%{INT}: \[mem %{BASE16NUM}-%{BASE16NUM}\]$",
        "^\s+sd\w+: (sd\w+\d ?)+$",
        "^\snode\s+%{INT}: \[mem %{BASE16NUM}-%{BASE16NUM}\]$",
        "^acpi %{PNPBUS}: _OSC: OS supports \[ASPM ClockPM Segments MSI\]$",
        "^acpiphp: ACPI Hot Plug PCI Controller Driver version: [0-9.]+$",
        "^acpiphp: Slot \[%{INT}\] registered$",
        "^alg: No test for (crc32|__gcm-aes-aesni) \((crc32-pclmul|__driver-gcm-aes-aesni)\)$",
        "^allocated %{INT} bytes of page_cgroup$",
        "^alua: device handler registered$",
        "^ata%{INT}: PATA max MWDMA2 cmd %{BASE16NUM} ctl %{BASE16NUM} bmdma %{BASE16NUM} irq %{INT}$",
        "^ata%{INT}\.%{INT}: ACPI cmd [0-9a-f]{2}/([0-9a-f]{2}:){5}[0-9a-f]{2} \((SET (FEATURES|MULTIPLE MODE)|SECURITY FREEZE LOCK)\) (filtered out|succeeded)$",
        "^ata%{INT}\.%{INT}: ATAPI: QEMU DVD-ROM, [0-9.]+, max UDMA/(33|66|100|133)$",
        "^ata%{INT}\.%{INT}: NODEV after polling detection$",
        "^ata%{INT}\.%{INT}: configured for (UDMA/(33|66|100|133)|MWDMA2)$",
        "^ata%{INT}\.%{INT}: revalidation failed \(errno=%{INT}\)$",
        "^ata%{INT}\.%{INT}: status: { DRDY }$",
        "^ata%{INT}: link is slow to respond, please be patient \(ready=0\)$",
        "^ata_piix %{PCIDEV}: version [0-9.]+$",
        "^atomic64 test passed for x86-64 platform with CX8 and with SSE$",
        "^audit: initializing netlink socket \(disabled\)$",
        "^brd: module loaded$",
        "^cache: parent cpu%{INT} should not be sleeping$",
        "^cdrom: Uniform CD-ROM driver Revision: [0-9.]+$",
        "^console \[tty%{INT}\] enabled$",
        "^cpuidle: using governor (ladder|menu)$",
        "^crash memory driver: version [0-9.]+$",
        "^devtmpfs: initialized$",
        "^dracut: Starting plymouth daemon$",
        "^dracut: Switching root$",
        "^dracut:$",
        "^drop_monitor: Initializing network drop monitor service$",
        "^e820: BIOS-provided physical RAM map:$",
        "^e820: \[mem %{BASE16NUM}-%{BASE16NUM}\] available for PCI devices$",
        "^e820: last_pfn = %{BASE16NUM} max_arch_pfn = %{BASE16NUM}$",
        "^e820: remove \[mem %{BASE16NUM}-%{BASE16NUM}\] usable$",
        "^e820: reserve RAM buffer \[mem %{BASE16NUM}-%{BASE16NUM}\]$",
        "^e820: update \[mem %{BASE16NUM}-%{BASE16NUM}\] usable ==> reserved$",
        "^emc: device handler registered$",
        "^fb%{INT}: VESA VGA frame buffer device$",
        "^fbcon: qxldrmfb \(fb%{INT}\) is primary device$",
        "^found SMP MP-table at \[mem %{BASE16NUM}-%{BASE16NUM}\] mapped at \[%{BASE16NUM}\]$",
        "^ftdi_sio %{USBDEV}: FTDI USB Serial Device converter detected$",
        "^ftdi_sio %{USBDEV}: device disconnected$",
        "^ftdi_sio ttyUSB%{INT}: FTDI USB Serial Device converter now disconnected from ttyUSB%{INT}$",
        "^ftrace: allocating %{INT} entries in %{INT} pages$",
        "^hidraw: raw HID events driver \(C\) Jiri Kosina$",
        "^hp_sw: device handler registered$",
        "^hub %{USBDEV}: %{INT} ports detected$",
        "^hub %{USBDEV}: USB hub found$",
        "^i8042: PNP: PS/2 Controller \[PNP%{BASE16NUM}:KBD,PNP%{BASE16NUM}:MOU\] at %{BASE16NUM},%{BASE16NUM} irq %{INT},%{INT}$",
        "^init_memory_mapping: \[mem %{BASE16NUM}-%{BASE16NUM}\]$",
        "^input: %{DATA} as /devices/%{DATA}/input/input%{INT}$",
        "^intel_idle: does not run on family %{INT} model %{INT}$",
        "^io scheduler (anticipatory|cfq|deadline|noop) registered( \(default\))?$",
        "^ip6?_tables: \(C\) %{INT}-%{INT} Netfilter Core Team$",
        "^kexec: crashkernel=auto resulted in zero bytes of reserved memory.$",
        "^kvm-clock: Using msrs %{BASE16NUM} and %{BASE16NUM}$",
        "^kvm-clock: cpu %{INT}, msr %{BASE16NUM}:%{BASE16NUM}, primary cpu clock$",
        "^kvm-clock: using sched offset of %{INT} cycles$",
        "^kvm-stealtime: cpu %{INT}, msr %{BASE16NUM}$",
        "^libata version [0-9.]+ loaded\.$",
        "^libphy: Fixed MDIO Bus: probed$",
        "^lo: Disabled Privacy Extensions$",
        "^lowmem_reserve\[\]: %{INT} %{INT} %{INT} %{INT}$",
        "^mce: CPU supports %{INT} MCE banks$",
        "^mceusb %{USBDEV}: (resume|suspend)$",
        "^md: data-check of RAID array md%{INT}$",
        "^md: delaying data-check of md%{INT} until md%{INT} has finished \(they share one or more physical units\)$",
        "^md: md%{INT}: data-check done\.$",
        "^md: minimum _guaranteed_ speed: %{INT} KB\/sec\/disk\.$",
        "^md: using %{INT}k window, over a total of %{INT}k\.$",
        "^md: using maximum available idle IO bandwidth \(but not more than %{INT} KB\/sec\) for data-check\.$",
        "^microcode: CPU%{INT} sig=%{BASE16NUM}, pf=%{BASE16NUM}, revision=%{BASE16NUM}$",
        "^microcode: Microcode Update Driver: v[0-9.]+ <tigran@aivazian\.fsnet\.co\.uk>, Peter Oruba$",
        "^msgmni has been set to %{INT}$",
        "^nf_conntrack version [0-9.]+ \(%{INT} buckets, %{INT} max\)$",
        "^nr_irqs_gsi: %{INT}$",
        "^ohci_hcd: USB 1\.1 'Open' Host Controller \(OHCI\) Driver$",
        "^pci %{PCIDEV}: Activating ISA DMA hang workarounds$",
        "^pci %{PCIDEV}: Boot video device$",
        "^pci %{PCIDEV}: Limiting direct PCI/PCI transfers$",
        "^pci %{PCIDEV}: PCI INT [ABCD] -> Link\[LNK\w\] -> GSI %{INT} \(level, high\) -> IRQ %{INT}$",
        "^pci %{PCIDEV}: PCI INT [ABCD] disabled$",
        "^pci %{PCIDEV}: PIIX3: Enabling Passive Release$",
        "^pci %{PCIDEV}: \[%{BASE16NUM}:%{BASE16NUM}\] type %{BASE16NUM} class %{BASE16NUM}$",
        "^pci %{PCIDEV}: quirk: \[io  0x[0-9a-f]{4}-0x[0-9a-f]{4}\] claimed by PIIX4 (ACPI|SMB)$",
        "^pci %{PCIDEV}: reg %{BASE16NUM}: \[(io|mem)\s+%{BASE16NUM}-%{BASE16NUM}\]$",
        "^pci %{PCIDEV}:( legacy IDE quirk:)? reg %{BASE16NUM}: \[(io|mem)\s+%{BASE16NUM}(-%{BASE16NUM})?( pref)?\]$",
        "^pci_bus %{PCIBUS}: resource %{BASE16NUM} \[(io|mem)\s+%{BASE16NUM}-%{BASE16NUM}\]$",
        "^pci_bus %{PCIBUS}: root bus resource \[(bus|io|mem)  ?%{BASE16NUM}-%{BASE16NUM}\]$",
        "^pci_hotplug: PCI Hot Plug PCI Core version: [0-9.]+$",
        "^pci_root %{PNPBUS}: host bridge window \[(io|mem)\s+%{BASE16NUM}-%{BASE16NUM}\]$",
        "^pciehp: PCI Express Hot Plug Controller Driver version: [0-9.]+$",
        "^pcpu-alloc: (\S+ )+alloc=%{INT}\*%{INT}$",
        "^pcpu-alloc: \[%{INT}\] (\d{2} )+$",
        "^pid_max: default: %{INT} minimum: %{INT}$",
        "^piix4_smbus %{PCIDEV}: SMBus Host Controller at 0x[0-9a-fA-F]{3}, revision %{INT}$",
        "^please try 'cgroup_disable=memory' option if you don't want memory cgroups$",
        "^pnp %{PNPBASE}: Plug and Play ACPI device, IDs %{PNPDEV} \(active\)$",
        "^pnp %{PNPBASE}: \[(dma|irq) %{INT}\]$",
        "^pnp %{PNPBASE}: \[io  0x[0-9a-f]{4}(-0x[0-9a-f]{4})?\]$",
        "^pnp: PnP ACPI init$",
        "^pnp: PnP ACPI: found %{INT} devices$",
        "^ppdev: user-space parallel port driver$",
        "^qxl %{PCIDEV}: fb%{INT}: qxldrmfb frame buffer device$",
        "^qxl %{PCIDEV}: registered panic notifier$",
        "^rdac: device handler registered$",
        "^registered taskstats version %{INT}$",
        "^rtc_cmos [0-9a-f]{2}:[0-9a-f]{2}: RTC can wake from S%{INT}$",
        "^rtc_cmos [0-9a-f]{2}:[0-9a-f]{2}: System wakeup disabled by ACPI$",
        "^rtc_cmos [0-9a-f]{2}:[0-9a-f]{2}: alarms up to one day, %{INT} bytes nvram$",
        "^rtc_cmos [0-9a-f]{2}:[0-9a-f]{2}: rtc core: registered rtc_cmos as rtc%{INT}$",
        "^rtc_cmos [0-9a-f]{2}:[0-9a-f]{2}: setting system clock to %{TIMESTAMP_ISO8601} %{TZ} \(%{INT}\)$",
        "^scsi (\d:){4} (CD-ROM|Direct-Access)\s%{DATA}\s+%{DATA} PQ: %{INT} ANSI: %{INT}$",
        "^scsi host%{INT}: %{DATA}$",
        "^sd (\d:){4} Attached scsi generic sg%{INT} type %{INT}$",
        "^sd (\d:){4} \[%{DATA}\] %{INT} 512-byte logical blocks: \(%{BASE10NUM} %{MEMUNITS}/%{BASE10NUM} %{MEMUNITS}\)$",
        "^sd (\d:){4} \[%{DATA}\] (Attached SCSI|Starting|Stopping) disk$",
        "^sd (\d:){4} \[%{DATA}\] Mode Sense: \d\d \d\d \d\d \d\d$",
        "^sd (\d:){4} \[%{DATA}\] Synchronizing SCSI cache$",
        "^sd (\d:){4} \[%{DATA}\] Write Protect is o(ff|n)$",
        "^sd (\d:){4} \[%{DATA}\] Write cache: (dis|en)abled, read cache: (dis|en)abled(, doesn't support DPO or FUA)?$",
        "^serio: i8042 (AUX|KBD) port at %{BASE16NUM},%{BASE16NUM} irq %{INT}$",
        "^setup_percpu: NR_CPUS:%{INT} nr_cpumask_bits:%{INT} nr_cpu_ids:%{INT} nr_node_ids:%{INT}$",
        "^sha(1|256)_ssse3: Using SSSE3 optimized SHA-(1|256) implementation$",
        "^smpboot: Allowing %{INT} CPUs, %{INT} hotplug CPUs$",
        "^smpboot: Booting Node %{INT} Processor %{INT} APIC %{BASE16NUM}$",
        "^smpboot: CPU %{INT} is now offline$",
        "^smpboot: CPU%{INT}: %{DATA} \(fam: %{BASE16NUM}, model: %{BASE16NUM}, stepping: %{BASE16NUM}\)$",
        "^smpboot: Total of %{INT} processors activated \(%{BASE10NUM} BogoMIPS\)$",
        "^sr (\d:){4} Attached scsi CD-ROM sr%{INT}$",
        "^sr (\d:){4} Attached scsi generic sg%{INT} type %{INT}$",
        "^sr (\d:){4} \[%{DATA}\] scsi%{INT}-mmc drive: %{INT}x/%{INT}x cd/rw xa/form2 tray$",
        "^tsc: Detected %{BASE10NUM} MHz processor$",
        "^tsc: Refined TSC clocksource calibration: %{BASE10NUM} MHz$",
        "^uhci_hcd %{PCIDEV}: UHCI Host Controller$",
        "^uhci_hcd: USB Universal Host Controller Interface driver$",
        "^usb %{USBBUS}: Detected FT232BM$",
        "^usb %{USBBUS}: FTDI USB Serial Device converter now attached to ttyUSB%{INT}$",
        "^usb %{USBBUS}: reset full-speed USB device number %{INT} using [eou]hci(-pci|_hcd)$",
        "^usb %{USBDEV}: rebind failed: %{INT}$",
        "^usb usb%{INT}: Manufacturer: %{DATA} [eou]hci(-pci|_hcd)$",
        "^usb usb%{INT}: New USB device found, idVendor=%{BASE16NUM}, idProduct=%{BASE16NUM}$",
        "^usb usb%{INT}: New USB device strings: Mfr=%{BASE16NUM}, Product=%{BASE16NUM}, SerialNumber=%{BASE16NUM}$",
        "^usb usb%{INT}: Product: UHCI Host Controller$",
        "^usb usb%{INT}: SerialNumber: %{PCIDEV}$",
        "^usb usb%{INT}: configuration #%{INT} chosen from %{INT} choice$",
        "^usb usb%{INT}: root hub lost power or was reset$",
        "^usbcore: registered new device driver usb$",
        "^usbcore: registered new interface driver (hiddev|hub|usbfs|usbhid|usbserial(_generic)?)$",
        "^usbhid: USB HID core driver$",
        "^usbhid: v[0-9.]+:USB HID core driver$",
        "^usbserial: USB Serial support registered for generic$",
        "^vesafb: scrolling: redraw$",
        "^vgaarb: bridge control possible %{PCIDEV}$",
        "^vgaarb: device added: PCI:%{PCIDEV},decodes=io\+mem,owns=io\+mem,locks=none$",
        "^vgaarb: loaded$",
        "^virtio-pci %{PCIDEV}: virtio_pci: leaving for legacy driver$",
        "^x86 PAT enabled: cpu %{INT}, old %{BASE16NUM}, new %{BASE16NUM}$",
        "^x86: Booting SMP configuration:$",
        "^zbud: loaded$",
        "^zpool: loaded$"
      ] }
    } 
    grok { 
      patterns_dir => [ "/etc/logstash/patterns.d/" ] 
      tag_on_failure => [ ] 
      add_tag => [ "Known Message", "Error"] 
      match => { "message" => [ 
        "^CPU: %{INT} PID: %{INT} Comm: %{NOTSPACE} Not tainted %{DATA} #%{INT}$",
        "^%{DATA}\[%{INT}\]: segfault at %{INT} ip %{BASE16NUM} sp %{BASE16NUM} error %{INT} in %{DATA}\[%{BASE16NUM}\+%{BASE16NUM}\]$",
        "^%{INT} pages HighMem\/MovableOnly$",
        "^%{NOTSPACE} cpuset=%{PATH} mems_allowed=%{INT}$",
        "^%{NOTSPACE} invoked oom-killer: gfp_mask=%{BASE16NUM}, order=%{INT}, oom_score_adj=%{INT}$",
        "^%{NOTSPACE}\s+D %{BASE16NUM}\s+%{INT}\s+%{INT}\s+%{INT}\s+%{BASE16NUM}$",
        "^CPU%{INT}: Core temperature above threshold, cpu clock throttled \(total events = %{INT}\)$",
        "^Call Trace:$",
        "^INFO: task %{DATA}:%{INT} blocked for more than 120 seconds.$",
        "^Killed process %{POSINT:[syslog][pid]} \(%{DATA}\) total-vm:%{INT}kB, anon-rss:%{INT}kB, file-rss:%{INT}kB$",
        "^Mem-Info:$",
        "^Out of memory: Kill process %{POSINT:[syslog][pid]} \(%{DATA}\) score %{POSINT} or sacrifice child$",
        "^\"echo 0 > /proc/sys/kernel/hung_task_timeout_secs\" disables this message\.$",
        "^\[<%{BASE16NUM}>\] (\? )?%{NOTSPACE} \[%{DATA:[kernel][module]}\]$",
        "^\[ pid \]   uid  tgid total_vm      rss nr_ptes swapents oom_score_adj name$",
        "^\[\s*%{INT:[syslog][pid]}\]\s+%{INT:[user][src][uid]}\s+%{INT}\s+%{INT}\s+%{INT}\s+%{INT}\s+%{INT}\s+%{INT}\s+%{DATA}$",
        "^\[sched_delayed\] sched: RT throttling activated$",
        "^\s*%{BASE16NUM} %{BASE16NUM} %{BASE16NUM} %{BASE16NUM}$",
        "^\s*\[<%{BASE16NUM}>\] (\? )?%{DATA}\+%{BASE16NUM}\/%{BASE16NUM}$",
        "^acpi %{PNPBUS}: _OSC failed \(AE_NOT_FOUND\); disabling ASPM$",
        "^acpi %{PNPBUS}: fail to add MMCONFIG information, can't access extended PCI configuration space under this bridge\.$",
        "^active_anon:%{INT} inactive_anon:%{INT} isolated_anon:%{INT}$",
        "^ata%{INT}: EH complete$",
        "^ata%{INT}: drained %{INT} bytes to clear DRQ$",
        "^ata%{INT}: lost interrupt \(Status %{BASE16NUM}\)$",
        "^ata%{INT}: soft resetting link$",
        "^ata%{INT}\.%{INT}: cmd a0\/00:00:00:08:00/00:00:00:00:00\/a0 tag 0 pio 16392 in$",
        "^ata%{INT}\.%{INT}: disabled$",
        "^ata%{INT}\.%{INT}: exception Emask %{BASE16NUM} SAct %{BASE16NUM} SErr %{BASE16NUM} action %{BASE16NUM} frozen$",
        "^ata%{INT}\.%{INT}: failed to IDENTIFY \(I\/O error, err_mask=%{BASE16NUM}\)$",
        "^ata%{INT}\.%{INT}: failed to set xfermode \(err_mask=%{BASE16NUM}\)$",
        "^ata%{INT}\.%{INT}: qc timeout \(cmd %{BASE16NUM}$",
        "^ata%{INT}\.%{INT}: qc timeout \(cmd %{BASE16NUM}\)$",
        "^device-mapper: thin: Deletion of thin device %{POSINT} failed\.$",
        "^hrtimer: interrupt took %{INT} ns$",
        "^mce_notify_irq: %{INT} callbacks suppressed$",
        "^sd (\d:){4} \[sd\w+\] abort$",
        "^snd_hda_codec_hdmi %{DATA}: HDMI: invalid ELD data byte %{INT}$",
        "^traps: %{WORD}\[%{INT:[pid]}\] trap %{WORD} ip:%{BASE16NUM} sp:%{BASE16NUM} error:%{INT}$"
      ] }
    } 
    grok { 
      patterns_dir => [ "/etc/logstash/patterns.d/" ] 
      tag_on_failure => [ ] 
      add_tag => [ "Known Message", "Alert"] 
      match => { "message" => [ 
        "^net_ratelimit: %{INT} callbacks suppressed$",
        "^device veth%{BASE16NUM} entered promiscuous mode$",
        "^device %{INTF_SRC} (entered|left) promiscuous mode$"
      ] }
    } 
    if [@metadata][iptables_back] {
      mutate {
        add_field => { "[connection][proto][name]" => "%{IP_PROTO}" }
        replace => { "type" => "firewall" }
      }
      kv {
        source => "[@metadata][iptables_back]"
        target => "[connection][proto]"
        value_split => "="
      }
      mutate {
        add_field => { 
          "[host][src][port]" => "%{[connection][proto][SPT]}"
          "[host]dst][port]"  => "%{[connection][proto][DPT]}"
        }
      }
    }
  }
}
