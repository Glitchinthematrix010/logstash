filter { 
  if [type] == "syslog" or [type] == "cee" and [syslog][identifier] == "kernel" { 
    grok { 
      tag_on_failure => [ ] 
      add_tag => [ "Known Message" ] 
      match => { "message" => [ 
        "^\[\s*\d+\.\d+\] Atheros AR8216/AR8236/AR8316 ag71xx-mdio\.0:00: Port \d+ is (up|down)"
      ] } 
    } 
    grok { 
      patterns_dir => [ "/etc/logstash/patterns.d/" ] 
      tag_on_failure => [ ] 
      add_tag => [ "Known Message", "Benign"] 
      match => { "message" => [ 
        "^CPU%{INT}: Core temperature/speed normal$",
        "^Deactivating swap %{PATH}\.\.\.$",
        "^XFS \(dm-%{BASE10NUM}\): (Ending clean mount|Mounting V4 Filesystem|Unmounting Filesystem)$",
        "^IPv6: ADDRCONF\(NETDEV_CHANGE\): %{INTF_SRC}: link becomes ready$",
        "^IPv6: ADDRCONF\(NETDEV_UP\): %{INTF_SRC}: link is not ready$",
        "^%{INTF_SRC}: port %{BASE10NUM}\(%{INTF_DST}\) entered (disabled|forwarding) state$",
        "^SELinux: initialized \(dev (devpts|dm-%{BASE10NUM}|mqueue|proc|sysfs|tmpfs), type (devpts|mqueue|proc|sysfs|tmpfs|xfs)\), uses ((genfs_contexts|labeling|mountpoint|transition SIDs|xattr) ?)+$"
      ] }
    } 
    grok { 
      tag_on_failure => [ ] 
      add_tag => [ "Known Message", "Error"] 
      match => { "message" => [ 
        "^CPU%{INT}: Core temperature above threshold, cpu clock throttled \(total events = %{INT}\)$",
        "^sd %{BASE10NUM}:%{BASE10NUM}:%{BASE10NUM}:%{BASE10NUM}: \[sda\] abort$"
      ] }
    } 
    grok { 
      patterns_dir => [ "/etc/logstash/patterns.d/" ] 
      tag_on_failure => [ ] 
      add_tag => [ "Known Message", "Alert"] 
      match => { "message" => [ 
        "^device %{INTF_SRC} (enetered|left) promiscuous mode$"
      ] }
    } 
  }
}
